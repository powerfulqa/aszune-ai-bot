
> aszuneai@1.9.0 test
> jest

  console.log
    [2025-11-20T15:31:31.089Z] [INFO] Final cache statistics:

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    { hits: 10, misses: 5 }

      at Logger.log [as info] (src/utils/logger.js:153:25)

  console.warn
    [2025-11-20T15:31:31.140Z] [WARN] Failed to log API metric test_metric: DB error

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at PerplexityService.warn [as _trackApiPerformance] (src/services/perplexity-secure.js:575:14)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-coverage.test.js:196:9)

  console.warn
    [2025-11-20T15:31:31.147Z] [WARN] Failed to log API metric api_cache_hit_time: DB error

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at PerplexityService.warn [as _trackApiPerformance] (src/services/perplexity-secure.js:575:14)
      at PerplexityService._trackCacheHitPerformance (src/services/perplexity-secure.js:587:5)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-coverage.test.js:204:9)

  console.warn
    [2025-11-20T15:31:31.151Z] [WARN] Failed to log API metric memory_usage_delta: DB error

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at PerplexityService.warn [as _trackApiPerformance] (src/services/perplexity-secure.js:575:14)
      at PerplexityService._trackCacheHitPerformance (src/services/perplexity-secure.js:593:5)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-coverage.test.js:204:9)

  console.warn
    [2025-11-20T15:31:31.155Z] [WARN] Failed to log API metric api_response_time: DB error

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at PerplexityService.warn [as _trackApiPerformance] (src/services/perplexity-secure.js:575:14)
      at PerplexityService._trackApiCallPerformance (src/services/perplexity-secure.js:615:5)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-coverage.test.js:228:9)

  console.warn
    [2025-11-20T15:31:31.159Z] [WARN] Failed to log API metric memory_usage_delta: DB error

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at PerplexityService.warn [as _trackApiPerformance] (src/services/perplexity-secure.js:575:14)
      at PerplexityService._trackApiCallPerformance (src/services/perplexity-secure.js:623:5)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-coverage.test.js:228:9)

  console.warn
    [2025-11-20T15:31:31.162Z] [WARN] Failed to log API metric memory_usage_current: DB error

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at PerplexityService.warn [as _trackApiPerformance] (src/services/perplexity-secure.js:575:14)
      at PerplexityService._trackApiCallPerformance (src/services/perplexity-secure.js:627:5)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-coverage.test.js:228:9)

  console.warn
    [2025-11-20T15:31:31.168Z] [WARN] Failed to log API metric api_error_time: DB error

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at PerplexityService.warn [as _trackApiPerformance] (src/services/perplexity-secure.js:575:14)
      at PerplexityService._trackApiErrorPerformance (src/services/perplexity-secure.js:640:5)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-coverage.test.js:261:9)

  console.warn
    [2025-11-20T15:31:31.171Z] [WARN] Failed to log API metric memory_usage_delta: DB error

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at PerplexityService.warn [as _trackApiPerformance] (src/services/perplexity-secure.js:575:14)
      at PerplexityService._trackApiErrorPerformance (src/services/perplexity-secure.js:646:5)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-coverage.test.js:261:9)

  console.warn
    [2025-11-20T15:31:32.421Z] [WARN] Database operation failed:

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at warn (src/services/chat.js:296:12)
      at processUserMessageStorage (src/services/chat.js:362:11)
      at Object.<anonymous> (__tests__/unit/chat-service-basic.test.js:87:5)

  console.warn
    Failed to add user message for 123456789012345678: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
     [90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
    [31m[1m>[22m[39m[90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m     |[39m                         [31m[1m^[22m[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m
     [90m 173 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.warn (src/utils/logger.js:170:25)
      at warn (src/services/chat.js:296:12)
      at processUserMessageStorage (src/services/chat.js:362:11)
      at Object.<anonymous> (__tests__/unit/chat-service-basic.test.js:87:5)

  console.log
    [2025-11-20T15:31:32.471Z] [INFO] Detected simple reminder request from user user123: "remind me in 5 minutes"

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:32.474Z] [INFO] Detected simple reminder request from user user123: "remind me in 5 minutes"

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:31:32.475Z] [ERROR] Error creating simple reminder:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at error (src/services/chat.js:210:12)
      at checkForSimpleReminderRequest (src/services/chat.js:154:12)
      at Object.<anonymous> (__tests__/unit/chat-service-basic.test.js:157:22)

  console.error
    Error: Test error

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at error (src/services/chat.js:210:12)
      at checkForSimpleReminderRequest (src/services/chat.js:154:12)
      at Object.<anonymous> (__tests__/unit/chat-service-basic.test.js:157:22)

  console.error
    Stack: Error: Test error
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\chat-service-basic.test.js:155:51)
        at Promise.then.completed (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:316:40)
        at _runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at error (src/services/chat.js:210:12)
      at checkForSimpleReminderRequest (src/services/chat.js:154:12)
      at Object.<anonymous> (__tests__/unit/chat-service-basic.test.js:157:22)

  console.log
    [2025-11-20T15:31:32.500Z] [INFO] Detected simple reminder request from user user123: "remind me to check email in 10 minutes"

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:32.501Z] [INFO] Detected simple reminder request from user user123: "please remind me about meeting in 1 hour"

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:32.501Z] [INFO] Detected simple reminder request from user user123: "can you remind me to call in 30 minutes"

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:32.502Z] [INFO] Detected simple reminder request from user user123: "set a reminder to take pills in 2 hours"

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:32.502Z] [INFO] Detected simple reminder request from user user123: "remind me in 15 minutes"

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:32.504Z] [INFO] Detected simple reminder request from user user123: "remind me in 15 minutes"

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:32.505Z] [INFO] Detected simple reminder request from user user123: "remind me in 5 minutes"

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:32.507Z] [INFO] Detected simple reminder request from user user123: "remind me in 10 minutes"

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:32.509Z] [INFO] Detected simple reminder request from user user123: "remind me to do something in 5 minutes"

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:31:32.509Z] [ERROR] Error creating simple reminder:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at error (src/services/chat.js:210:12)
      at checkForSimpleReminderRequest (src/services/chat.js:154:12)
      at Object.<anonymous> (__tests__/unit/chat-service-basic.test.js:247:22)

  console.error
    Error: Command failed

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at error (src/services/chat.js:210:12)
      at checkForSimpleReminderRequest (src/services/chat.js:154:12)
      at Object.<anonymous> (__tests__/unit/chat-service-basic.test.js:247:22)

  console.error
    Stack: Error: Command failed
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\chat-service-basic.test.js:245:51)
        at Promise.then.completed (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:316:40)
        at _runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at error (src/services/chat.js:210:12)
      at checkForSimpleReminderRequest (src/services/chat.js:154:12)
      at Object.<anonymous> (__tests__/unit/chat-service-basic.test.js:247:22)

  console.warn
    [2025-11-20T15:31:32.530Z] [WARN] Database operation failed:

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at warn (src/services/chat.js:296:12)
      at processUserMessageStorage (src/services/chat.js:362:11)
      at Object.<anonymous> (__tests__/unit/chat-service-basic.test.js:268:22)

  console.warn
    Failed to add user message for 123456789012345678: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
     [90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
    [31m[1m>[22m[39m[90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m     |[39m                         [31m[1m^[22m[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m
     [90m 173 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.warn (src/utils/logger.js:170:25)
      at warn (src/services/chat.js:296:12)
      at processUserMessageStorage (src/services/chat.js:362:11)
      at Object.<anonymous> (__tests__/unit/chat-service-basic.test.js:268:22)

  console.error
    [2025-11-20T15:31:38.507Z] [ERROR] Error in extracting response content:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as _extractResponseContent] (src/services/perplexity-secure.js:491:42)
      at _extractResponseContent (__tests__/unit/services/perplexity-secure-comprehensive.test.js:454:38)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.toThrow (__tests__/unit/services/perplexity-secure-comprehensive.test.js:454:69)

  console.error
    Error: Empty response received from the service.

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as _extractResponseContent] (src/services/perplexity-secure.js:491:42)
      at _extractResponseContent (__tests__/unit/services/perplexity-secure-comprehensive.test.js:454:38)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.toThrow (__tests__/unit/services/perplexity-secure-comprehensive.test.js:454:69)

  console.error
    Stack: Error: Empty response received from the service.
        at PerplexityService._extractResponseContent (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:469:15)
        at _extractResponseContent (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-comprehensive.test.js:454:38)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\expect\build\toThrowMatchers.js:74:11)
        at Object.throwingMatcher [as toThrow] (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\expect\build\index.js:320:21)
        at Object.toThrow (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-comprehensive.test.js:454:69)
        at Promise.then.completed (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:316:40)
        at _runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as _extractResponseContent] (src/services/perplexity-secure.js:491:42)
      at _extractResponseContent (__tests__/unit/services/perplexity-secure-comprehensive.test.js:454:38)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.toThrow (__tests__/unit/services/perplexity-secure-comprehensive.test.js:454:69)

  console.warn
    [2025-11-20T15:31:38.538Z] [WARN] Response processing error: An unexpected error occurred. Please try again later.

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at PerplexityService.warn [as _extractResponseContent] (src/services/perplexity-secure.js:492:14)
      at _extractResponseContent (__tests__/unit/services/perplexity-secure-comprehensive.test.js:454:38)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.toThrow (__tests__/unit/services/perplexity-secure-comprehensive.test.js:454:69)

  console.error
    [2025-11-20T15:31:38.543Z] [ERROR] Error in extracting response content:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as _extractResponseContent] (src/services/perplexity-secure.js:491:42)
      at _extractResponseContent (__tests__/unit/services/perplexity-secure-comprehensive.test.js:459:38)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.toThrow (__tests__/unit/services/perplexity-secure-comprehensive.test.js:459:73)

  console.error
    Error: Empty response received from the service.

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as _extractResponseContent] (src/services/perplexity-secure.js:491:42)
      at _extractResponseContent (__tests__/unit/services/perplexity-secure-comprehensive.test.js:459:38)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.toThrow (__tests__/unit/services/perplexity-secure-comprehensive.test.js:459:73)

  console.error
    Stack: Error: Empty response received from the service.
        at PerplexityService._extractResponseContent (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:474:15)
        at _extractResponseContent (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-comprehensive.test.js:459:38)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\expect\build\toThrowMatchers.js:74:11)
        at Object.throwingMatcher [as toThrow] (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\expect\build\index.js:320:21)
        at Object.toThrow (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-comprehensive.test.js:459:73)
        at Promise.then.completed (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:316:40)
        at _runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as _extractResponseContent] (src/services/perplexity-secure.js:491:42)
      at _extractResponseContent (__tests__/unit/services/perplexity-secure-comprehensive.test.js:459:38)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.toThrow (__tests__/unit/services/perplexity-secure-comprehensive.test.js:459:73)

  console.warn
    [2025-11-20T15:31:38.555Z] [WARN] Response processing error: An unexpected error occurred. Please try again later.

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at PerplexityService.warn [as _extractResponseContent] (src/services/perplexity-secure.js:492:14)
      at _extractResponseContent (__tests__/unit/services/perplexity-secure-comprehensive.test.js:459:38)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.toThrow (__tests__/unit/services/perplexity-secure-comprehensive.test.js:459:73)

  console.log
    [2025-11-20T15:31:38.583Z] [INFO] API Request: model="sonar", messages=2, temperature=0.2, max_tokens=256

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:38.587Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:38.588Z] [INFO] Request payload summary: model=sonar, messages=2, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:38.591Z] [INFO] API Request: model="sonar", messages=2, temperature=0.2, max_tokens=256

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:38.592Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:38.593Z] [INFO] Request payload summary: model=sonar, messages=2, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:31:38.593Z] [ERROR] API request failed for endpoint /chat/completions:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at PerplexityService.generateTextSummary (src/services/perplexity-secure.js:1061:22)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-comprehensive.test.js:741:7)

  console.error
    Error: Summary API error

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at PerplexityService.generateTextSummary (src/services/perplexity-secure.js:1061:22)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-comprehensive.test.js:741:7)

  console.error
    [2025-11-20T15:31:38.602Z] [ERROR] Error in API call to Perplexity API:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at PerplexityService.generateTextSummary (src/services/perplexity-secure.js:1061:22)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-comprehensive.test.js:741:7)

  console.error
    Error: Request failed: Summary API error

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at PerplexityService.generateTextSummary (src/services/perplexity-secure.js:1061:22)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-comprehensive.test.js:741:7)

  console.error
    Stack: Error: Request failed: Summary API error
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleRequestError] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:216:25)
        at ApiClient.handleRequestError [as makeRequest] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:124:18)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at PerplexityService.generateTextSummary (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:1061:22)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-comprehensive.test.js:741:7)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at PerplexityService.generateTextSummary (src/services/perplexity-secure.js:1061:22)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-comprehensive.test.js:741:7)

  console.error
    [2025-11-20T15:31:38.609Z] [ERROR] API request failed: The service is temporarily unavailable. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as sendChatRequest] (src/services/perplexity-secure.js:526:14)
      at PerplexityService.generateTextSummary (src/services/perplexity-secure.js:1061:22)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-comprehensive.test.js:741:7)

  console.error
    [2025-11-20T15:31:38.614Z] [ERROR] Error in getting cache statistics:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as getCacheStats] (src/services/perplexity-secure.js:96:42)
      at Object.getCacheStats (__tests__/unit/services/perplexity-secure-comprehensive.test.js:772:40)

  console.error
    Error: Cache error

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as getCacheStats] (src/services/perplexity-secure.js:96:42)
      at Object.getCacheStats (__tests__/unit/services/perplexity-secure-comprehensive.test.js:772:40)

  console.error
    Stack: Error: Cache error
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-comprehensive.test.js:768:17)
        at C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-mock\build\index.js:397:39
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-mock\build\index.js:404:13)
        at Object.mockConstructor [as getStats] (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-mock\build\index.js:148:19)
        at PerplexityService.getStats [as getCacheStats] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:94:32)
        at Object.getCacheStats (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-comprehensive.test.js:772:40)
        at Promise.then.completed (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:316:40)
        at _runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as getCacheStats] (src/services/perplexity-secure.js:96:42)
      at Object.getCacheStats (__tests__/unit/services/perplexity-secure-comprehensive.test.js:772:40)

  console.error
    [2025-11-20T15:31:38.620Z] [ERROR] Cache stats error: An unexpected error occurred. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as getCacheStats] (src/services/perplexity-secure.js:97:14)
      at Object.getCacheStats (__tests__/unit/services/perplexity-secure-comprehensive.test.js:772:40)

  console.error
    [2025-11-20T15:31:38.624Z] [ERROR] Error in getting cache statistics:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as getCacheStats] (src/services/perplexity-secure.js:96:42)
      at Object.getCacheStats (__tests__/unit/services/perplexity-secure-comprehensive.test.js:782:40)

  console.error
    Error: Cache manager not available

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as getCacheStats] (src/services/perplexity-secure.js:96:42)
      at Object.getCacheStats (__tests__/unit/services/perplexity-secure-comprehensive.test.js:782:40)

  console.error
    Stack: Error: Cache manager not available
        at PerplexityService.getCacheStats (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:92:15)
        at Object.getCacheStats (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-comprehensive.test.js:782:40)
        at Promise.then.completed (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:316:40)
        at _runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as getCacheStats] (src/services/perplexity-secure.js:96:42)
      at Object.getCacheStats (__tests__/unit/services/perplexity-secure-comprehensive.test.js:782:40)

  console.error
    [2025-11-20T15:31:38.632Z] [ERROR] Cache stats error: An unexpected error occurred. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as getCacheStats] (src/services/perplexity-secure.js:97:14)
      at Object.getCacheStats (__tests__/unit/services/perplexity-secure-comprehensive.test.js:782:40)

  console.error
    [2025-11-20T15:31:38.635Z] [ERROR] Error in getting cache statistics:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as getCacheStats] (src/services/perplexity-secure.js:96:42)
      at PerplexityService.getCacheStats [as shutdown] (src/services/perplexity-secure.js:163:29)
      at Object.shutdown (__tests__/unit/services/perplexity-secure-comprehensive.test.js:799:25)

  console.error
    Error: Cache manager not available

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as getCacheStats] (src/services/perplexity-secure.js:96:42)
      at PerplexityService.getCacheStats [as shutdown] (src/services/perplexity-secure.js:163:29)
      at Object.shutdown (__tests__/unit/services/perplexity-secure-comprehensive.test.js:799:25)

  console.error
    Stack: Error: Cache manager not available
        at PerplexityService.getCacheStats (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:92:15)
        at PerplexityService.getCacheStats [as shutdown] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:163:29)
        at Object.shutdown (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-comprehensive.test.js:799:25)
        at Promise.then.completed (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:316:40)
        at _runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as getCacheStats] (src/services/perplexity-secure.js:96:42)
      at PerplexityService.getCacheStats [as shutdown] (src/services/perplexity-secure.js:163:29)
      at Object.shutdown (__tests__/unit/services/perplexity-secure-comprehensive.test.js:799:25)

  console.error
    [2025-11-20T15:31:38.645Z] [ERROR] Cache stats error: An unexpected error occurred. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as getCacheStats] (src/services/perplexity-secure.js:97:14)
      at PerplexityService.getCacheStats [as shutdown] (src/services/perplexity-secure.js:163:29)
      at Object.shutdown (__tests__/unit/services/perplexity-secure-comprehensive.test.js:799:25)

  console.log
    [2025-11-20T15:31:38.648Z] [INFO] Final cache statistics:

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    {
      hits: 0,
      misses: 0,
      sets: 0,
      deletes: 0,
      evictions: 0,
      hitRate: 0,
      entryCount: 0,
      memoryUsage: 0,
      memoryUsageFormatted: '0 B',
      maxMemory: 0,
      maxMemoryFormatted: '0 B',
      maxSize: 0,
      uptime: 0,
      uptimeFormatted: '0s',
      evictionStrategy: 'hybrid',
      error: 'An unexpected error occurred. Please try again later.'
    }

      at Logger.log [as info] (src/utils/logger.js:153:25)

  console.error
    [2025-11-20T15:31:38.651Z] [ERROR] Error in getting cache statistics:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as getCacheStats] (src/services/perplexity-secure.js:96:42)
      at PerplexityService.getCacheStats [as shutdown] (src/services/perplexity-secure.js:163:29)
      at Object.shutdown (__tests__/unit/services/perplexity-secure-comprehensive.test.js:813:25)

  console.error
    Error: Cache manager not available

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as getCacheStats] (src/services/perplexity-secure.js:96:42)
      at PerplexityService.getCacheStats [as shutdown] (src/services/perplexity-secure.js:163:29)
      at Object.shutdown (__tests__/unit/services/perplexity-secure-comprehensive.test.js:813:25)

  console.error
    Stack: Error: Cache manager not available
        at PerplexityService.getCacheStats (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:92:15)
        at PerplexityService.getCacheStats [as shutdown] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:163:29)
        at Object.shutdown (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-comprehensive.test.js:813:25)
        at Promise.then.completed (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:316:40)
        at _runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as getCacheStats] (src/services/perplexity-secure.js:96:42)
      at PerplexityService.getCacheStats [as shutdown] (src/services/perplexity-secure.js:163:29)
      at Object.shutdown (__tests__/unit/services/perplexity-secure-comprehensive.test.js:813:25)

  console.error
    [2025-11-20T15:31:38.660Z] [ERROR] Cache stats error: An unexpected error occurred. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as getCacheStats] (src/services/perplexity-secure.js:97:14)
      at PerplexityService.getCacheStats [as shutdown] (src/services/perplexity-secure.js:163:29)
      at Object.shutdown (__tests__/unit/services/perplexity-secure-comprehensive.test.js:813:25)

  console.log
    [2025-11-20T15:31:38.662Z] [INFO] Final cache statistics:

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    {
      hits: 0,
      misses: 0,
      sets: 0,
      deletes: 0,
      evictions: 0,
      hitRate: 0,
      entryCount: 0,
      memoryUsage: 0,
      memoryUsageFormatted: '0 B',
      maxMemory: 0,
      maxMemoryFormatted: '0 B',
      maxSize: 0,
      uptime: 0,
      uptimeFormatted: '0s',
      evictionStrategy: 'hybrid',
      error: 'An unexpected error occurred. Please try again later.'
    }

      at Logger.log [as info] (src/utils/logger.js:153:25)

  console.warn
    [2025-11-20T15:31:43.311Z] [WARN] Failed to get user messages for 123: Query failed

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at DatabaseService.warn [as getUserMessages] (src/services/database.js:616:14)
      at getUserMessages (__tests__/unit/services/database.test.js:237:30)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.toThrow (__tests__/unit/services/database.test.js:237:58)

  console.warn
    [2025-11-20T15:31:43.338Z] [WARN] All schema attempts failed for user 123

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at DatabaseService.warn [as ensureUserExists] (src/services/database.js:763:16)
      at DatabaseService.ensureUserExists [as addUserMessage] (src/services/database.js:626:12)
      at addUserMessage (__tests__/unit/services/database.test.js:255:30)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.toThrow (__tests__/unit/services/database.test.js:255:68)

  console.log
    [2025-11-20T15:31:45.463Z] [INFO] API Request: model="sonar", messages=2, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:45.473Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:45.474Z] [INFO] Request payload summary: model=sonar, messages=2, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:45.488Z] [INFO] API Request: model="sonar", messages=2, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:45.489Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:45.489Z] [INFO] Request payload summary: model=sonar, messages=2, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:45.491Z] [INFO] API Request: model="sonar", messages=2, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:45.492Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:45.493Z] [INFO] Request payload summary: model=sonar, messages=2, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:45.505Z] [INFO] API Request: model="sonar", messages=2, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:45.505Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:45.506Z] [INFO] Request payload summary: model=sonar, messages=2, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:45.507Z] [INFO] API Request: model="sonar", messages=2, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:45.508Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:45.509Z] [INFO] Request payload summary: model=sonar, messages=2, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:45.525Z] [INFO] API Request: model="sonar", messages=2, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:45.526Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:45.527Z] [INFO] Request payload summary: model=sonar, messages=2, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:45.540Z] [INFO] API Request: model="sonar", messages=2, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:45.541Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:45.542Z] [INFO] Request payload summary: model=sonar, messages=2, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:45.555Z] [INFO] API Request: model="sonar", messages=2, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:45.556Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:45.556Z] [INFO] Request payload summary: model=sonar, messages=2, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:31:45.590Z] [ERROR] Error in loading cache:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at CacheManager.handleError [as loadCache] (src/services/cache-manager.js:202:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:191:7)

  console.error
    Error: Unexpected token 'i', "invalid json data" is not valid JSON

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at CacheManager.handleError [as loadCache] (src/services/cache-manager.js:202:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:191:7)

  console.error
    Stack: SyntaxError: Unexpected token 'i', "invalid json data" is not valid JSON
        at JSON.parse (<anonymous>)
        at CacheManager.parse [as loadCache] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\cache-manager.js:196:19)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-advanced.test.js:191:7)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at CacheManager.handleError [as loadCache] (src/services/cache-manager.js:202:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:191:7)

  console.warn
    [2025-11-20T15:31:45.604Z] [WARN] Cache load error: An unexpected error occurred. Please try again later.

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at CacheManager.warn [as loadCache] (src/services/cache-manager.js:203:14)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:191:7)

  console.error
    [2025-11-20T15:31:45.607Z] [ERROR] Error in saving cache:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at CacheManager.handleError [as saveCache] (src/services/cache-manager.js:224:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:192:7)

  console.error
    Error: Cache write error

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at CacheManager.handleError [as saveCache] (src/services/cache-manager.js:224:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:192:7)

  console.error
    Stack: Error: Cache write error
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-advanced.test.js:120:38)
        at Promise.then.completed (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:316:40)
        at _runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at CacheManager.handleError [as saveCache] (src/services/cache-manager.js:224:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:192:7)

  console.error
    [2025-11-20T15:31:45.613Z] [ERROR] Cache save error: An unexpected error occurred. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at CacheManager.error [as saveCache] (src/services/cache-manager.js:225:14)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:192:7)

  console.log
    [2025-11-20T15:31:45.616Z] [INFO] API Request: model="sonar", messages=2, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:45.617Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:45.618Z] [INFO] Request payload summary: model=sonar, messages=2, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:31:45.619Z] [ERROR] API request failed for endpoint /chat/completions:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:210:22)

  console.error
    Error: Temporary network error

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:210:22)

  console.error
    [2025-11-20T15:31:45.647Z] [ERROR] Error in API call to Perplexity API:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:210:22)

  console.error
    Error: Request failed: Temporary network error

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:210:22)

  console.error
    Stack: Error: Request failed: Temporary network error
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleRequestError] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:216:25)
        at ApiClient.handleRequestError [as makeRequest] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:124:18)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at ResponseProcessor.generateResponseWithRetry (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\response-processor.js:135:14)
        at PerplexityService._processChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:754:22)
        at PerplexityService.generateChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:815:23)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-advanced.test.js:210:22)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:210:22)

  console.error
    [2025-11-20T15:31:45.657Z] [ERROR] API request failed: An unexpected error occurred. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as sendChatRequest] (src/services/perplexity-secure.js:526:14)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:210:22)

  console.error
    [2025-11-20T15:31:45.659Z] [ERROR] Error in API retry:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at ResponseProcessor.handleError [as generateResponseWithRetry] (src/services/response-processor.js:141:22)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:210:22)

  console.error
    Error: Request failed: Temporary network error

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at ResponseProcessor.handleError [as generateResponseWithRetry] (src/services/response-processor.js:141:22)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:210:22)

  console.error
    Stack: Error: Request failed: Temporary network error
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleRequestError] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:216:25)
        at ApiClient.handleRequestError [as makeRequest] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:124:18)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at ResponseProcessor.generateResponseWithRetry (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\response-processor.js:135:14)
        at PerplexityService._processChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:754:22)
        at PerplexityService.generateChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:815:23)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-advanced.test.js:210:22)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at ResponseProcessor.handleError [as generateResponseWithRetry] (src/services/response-processor.js:141:22)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:210:22)

  console.log
    [2025-11-20T15:31:46.676Z] [INFO] API Request: model="sonar", messages=2, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:46.677Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:46.678Z] [INFO] Request payload summary: model=sonar, messages=2, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:46.689Z] [INFO] API Request: model="sonar", messages=2, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:46.690Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:46.691Z] [INFO] Request payload summary: model=sonar, messages=2, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:31:46.692Z] [ERROR] API request failed for endpoint /chat/completions:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:223:7)

  console.error
    Error: Permanent API error

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:223:7)

  console.error
    [2025-11-20T15:31:46.696Z] [ERROR] Error in API call to Perplexity API:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:223:7)

  console.error
    Error: Request failed: Permanent API error

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:223:7)

  console.error
    Stack: Error: Request failed: Permanent API error
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleRequestError] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:216:25)
        at ApiClient.handleRequestError [as makeRequest] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:124:18)
        at runNextTicks (node:internal/process/task_queues:65:5)
        at listOnTimeout (node:internal/timers:549:9)
        at processTimers (node:internal/timers:523:7)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at ResponseProcessor.generateResponseWithRetry (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\response-processor.js:135:14)
        at PerplexityService._processChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:754:22)
        at PerplexityService.generateChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:815:23)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-advanced.test.js:223:7)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:223:7)

  console.error
    [2025-11-20T15:31:46.702Z] [ERROR] API request failed: The service is temporarily unavailable. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as sendChatRequest] (src/services/perplexity-secure.js:526:14)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:223:7)

  console.error
    [2025-11-20T15:31:46.717Z] [ERROR] Error in generate chat response:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as generateChatResponse] (src/services/perplexity-secure.js:842:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:223:7)

  console.error
    Error: Request failed: Permanent API error

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as generateChatResponse] (src/services/perplexity-secure.js:842:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:223:7)

  console.error
    Stack: Error: Request failed: Permanent API error
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleRequestError] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:216:25)
        at ApiClient.handleRequestError [as makeRequest] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:124:18)
        at runNextTicks (node:internal/process/task_queues:65:5)
        at listOnTimeout (node:internal/timers:549:9)
        at processTimers (node:internal/timers:523:7)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at ResponseProcessor.generateResponseWithRetry (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\response-processor.js:135:14)
        at PerplexityService._processChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:754:22)
        at PerplexityService.generateChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:815:23)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-advanced.test.js:223:7)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as generateChatResponse] (src/services/perplexity-secure.js:842:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:223:7)

  console.error
    [2025-11-20T15:31:46.722Z] [ERROR] Failed to generate chat response: The service is temporarily unavailable. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as generateChatResponse] (src/services/perplexity-secure.js:846:14)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:223:7)

  console.log
    [2025-11-20T15:31:46.724Z] [INFO] API Request: model="sonar", messages=2, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:46.725Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:46.725Z] [INFO] Request payload summary: model=sonar, messages=2, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:31:46.726Z] [ERROR] API request failed for endpoint /chat/completions:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:238:22)

  console.error
    Error: Request timeout

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:238:22)

  console.error
    [2025-11-20T15:31:46.730Z] [ERROR] Error in API call to Perplexity API:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:238:22)

  console.error
    Error: Request failed: Request timeout

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:238:22)

  console.error
    Stack: Error: Request failed: Request timeout
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleRequestError] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:216:25)
        at ApiClient.handleRequestError [as makeRequest] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:124:18)
        at runNextTicks (node:internal/process/task_queues:65:5)
        at listOnTimeout (node:internal/timers:549:9)
        at processTimers (node:internal/timers:523:7)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at ResponseProcessor.generateResponseWithRetry (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\response-processor.js:135:14)
        at PerplexityService._processChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:754:22)
        at PerplexityService.generateChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:815:23)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-advanced.test.js:238:22)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:238:22)

  console.error
    [2025-11-20T15:31:46.736Z] [ERROR] API request failed: An unexpected error occurred. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as sendChatRequest] (src/services/perplexity-secure.js:526:14)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:238:22)

  console.error
    [2025-11-20T15:31:46.739Z] [ERROR] Error in API retry:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at ResponseProcessor.handleError [as generateResponseWithRetry] (src/services/response-processor.js:141:22)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:238:22)

  console.error
    Error: Request failed: Request timeout

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at ResponseProcessor.handleError [as generateResponseWithRetry] (src/services/response-processor.js:141:22)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:238:22)

  console.error
    Stack: Error: Request failed: Request timeout
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleRequestError] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:216:25)
        at ApiClient.handleRequestError [as makeRequest] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:124:18)
        at runNextTicks (node:internal/process/task_queues:65:5)
        at listOnTimeout (node:internal/timers:549:9)
        at processTimers (node:internal/timers:523:7)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at ResponseProcessor.generateResponseWithRetry (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\response-processor.js:135:14)
        at PerplexityService._processChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:754:22)
        at PerplexityService.generateChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:815:23)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-advanced.test.js:238:22)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at ResponseProcessor.handleError [as generateResponseWithRetry] (src/services/response-processor.js:141:22)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-advanced.test.js:238:22)

  console.log
    [2025-11-20T15:31:47.758Z] [INFO] API Request: model="sonar", messages=2, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:47.759Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:31:47.760Z] [INFO] Request payload summary: model=sonar, messages=2, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:31:51.572Z] [ERROR] Error in processAIResponse:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-service-advanced.test.js:82:5)

  console.error
    Error: API Error

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-service-advanced.test.js:82:5)

  console.error
    Stack: Error: API Error
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\chat-service-advanced.test.js:77:19)
        at Promise.then.completed (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:316:40)
        at _runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-service-advanced.test.js:82:5)

  console.error
    [2025-11-20T15:31:51.606Z] [ERROR] Error in chat generation:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at handleError (src/services/chat.js:423:38)
      at handleChatMessage (src/services/chat.js:387:5)
      at Object.<anonymous> (__tests__/unit/chat-service-advanced.test.js:82:5)

  console.error
    Error: API Error

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at handleError (src/services/chat.js:423:38)
      at handleChatMessage (src/services/chat.js:387:5)
      at Object.<anonymous> (__tests__/unit/chat-service-advanced.test.js:82:5)

  console.error
    Stack: Error: API Error
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\chat-service-advanced.test.js:77:19)
        at Promise.then.completed (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:316:40)
        at _runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at handleError (src/services/chat.js:423:38)
      at handleChatMessage (src/services/chat.js:387:5)
      at Object.<anonymous> (__tests__/unit/chat-service-advanced.test.js:82:5)

  console.error
    [2025-11-20T15:31:51.630Z] [ERROR] Error in processAIResponse:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-service-advanced.test.js:184:5)

  console.error
    Error: Request timeout

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-service-advanced.test.js:184:5)

  console.error
    Stack: Error: Request timeout
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\chat-service-advanced.test.js:181:62)
        at Promise.then.completed (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:316:40)
        at _runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-service-advanced.test.js:184:5)

  console.error
    [2025-11-20T15:31:51.637Z] [ERROR] Error in chat generation:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at handleError (src/services/chat.js:423:38)
      at handleChatMessage (src/services/chat.js:387:5)
      at Object.<anonymous> (__tests__/unit/chat-service-advanced.test.js:184:5)

  console.error
    Error: Request timeout

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at handleError (src/services/chat.js:423:38)
      at handleChatMessage (src/services/chat.js:387:5)
      at Object.<anonymous> (__tests__/unit/chat-service-advanced.test.js:184:5)

  console.error
    Stack: Error: Request timeout
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\chat-service-advanced.test.js:181:62)
        at Promise.then.completed (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:316:40)
        at _runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at handleError (src/services/chat.js:423:38)
      at handleChatMessage (src/services/chat.js:387:5)
      at Object.<anonymous> (__tests__/unit/chat-service-advanced.test.js:184:5)

  console.error
    [2025-11-20T15:31:51.646Z] [ERROR] Error in processAIResponse:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-service-advanced.test.js:203:5)

  console.error
    Error: Rate limit exceeded

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-service-advanced.test.js:203:5)

  console.error
    Stack: Error: Rate limit exceeded
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\chat-service-advanced.test.js:198:28)
        at Promise.then.completed (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:316:40)
        at _runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-service-advanced.test.js:203:5)

  console.warn
    [2025-11-20T15:31:51.651Z] [WARN] Rate limit error in chat generation:

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at Function.warn [as handleError] (src/utils/error-handler.js:189:14)
      at handleError (src/services/chat.js:423:38)
      at handleChatMessage (src/services/chat.js:387:5)
      at Object.<anonymous> (__tests__/unit/chat-service-advanced.test.js:203:5)

  console.warn
    {
      type: 'RATE_LIMIT_ERROR',
      context: 'chat generation',
      message: 'Rate limit exceeded',
      stack: 'Error: Rate limit exceeded\n' +
        '    at Object.<anonymous> (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\__tests__\\unit\\chat-service-advanced.test.js:198:28)\n' +
        '    at Promise.then.completed (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\node_modules\\jest-circus\\build\\utils.js:298:28)\n' +
        '    at new Promise (<anonymous>)\n' +
        '    at callAsyncCircusFn (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\node_modules\\jest-circus\\build\\utils.js:231:10)\n' +
        '    at _callCircusTest (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\node_modules\\jest-circus\\build\\run.js:316:40)\n' +
        '    at _runTest (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\node_modules\\jest-circus\\build\\run.js:252:3)\n' +
        '    at _runTestsForDescribeBlock (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\node_modules\\jest-circus\\build\\run.js:126:9)\n' +
        '    at _runTestsForDescribeBlock (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\node_modules\\jest-circus\\build\\run.js:121:9)\n' +
        '    at run (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\node_modules\\jest-circus\\build\\run.js:71:3)\n' +
        '    at runAndTransformResultsToJestFormat (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n' +
        '    at jestAdapter (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n' +
        '    at runTestInternal (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n' +
        '    at runTest (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\node_modules\\jest-runner\\build\\runTest.js:444:34)',
      code: undefined,
      statusCode: 429,
      timestamp: '2025-11-20T15:31:51.651Z',
      userId: '123456789012345678',
      messageLength: 5,
      sanitizedContent: 32
    }

    [0m [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
     [90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
    [31m[1m>[22m[39m[90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m     |[39m                         [31m[1m^[22m[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m
     [90m 173 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.warn (src/utils/logger.js:170:25)
      at Function.warn [as handleError] (src/utils/error-handler.js:189:14)
      at handleError (src/services/chat.js:423:38)
      at handleChatMessage (src/services/chat.js:387:5)
      at Object.<anonymous> (__tests__/unit/chat-service-advanced.test.js:203:5)

  console.warn
    [2025-11-20T15:32:02.042Z] [WARN] Invalid user ID: Invalid user ID format

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at warn (src/services/chat.js:87:12)
      at processUserMessage (src/services/chat.js:351:31)
      at Object.chatService (__tests__/unit/chat-error-branches.test.js:123:28)

  console.warn
    [2025-11-20T15:32:02.391Z] [WARN] Database operation failed:

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at warn (src/services/chat.js:296:12)
      at processUserMessageStorage (src/services/chat.js:362:11)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:153:7)

  console.warn
    Failed to add user message for user123: Failed to update user stats for user123: table user_stats has no column named username

    [0m [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
     [90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
    [31m[1m>[22m[39m[90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m     |[39m                         [31m[1m^[22m[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m
     [90m 173 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.warn (src/utils/logger.js:170:25)
      at warn (src/services/chat.js:296:12)
      at processUserMessageStorage (src/services/chat.js:362:11)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:153:7)

  console.error
    [2025-11-20T15:32:02.400Z] [ERROR] Error in processAIResponse:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:153:7)

  console.error
    Error: Timeout

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:153:7)

  console.error
    Stack: Error: Timeout
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\chat-error-branches.test.js:145:28)
        at Promise.then.completed (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:316:40)
        at _runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:153:7)

  console.warn
    [2025-11-20T15:32:02.604Z] [WARN] Database operation failed:

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at warn (src/services/chat.js:296:12)
      at processUserMessageStorage (src/services/chat.js:362:11)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:178:7)

  console.warn
    Failed to add user message for user123: Failed to update user stats for user123: table user_stats has no column named username

    [0m [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
     [90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
    [31m[1m>[22m[39m[90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m     |[39m                         [31m[1m^[22m[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m
     [90m 173 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.warn (src/utils/logger.js:170:25)
      at warn (src/services/chat.js:296:12)
      at processUserMessageStorage (src/services/chat.js:362:11)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:178:7)

  console.error
    [2025-11-20T15:32:02.609Z] [ERROR] Error in processAIResponse:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:178:7)

  console.error
    Error: Rate limited

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:178:7)

  console.error
    Stack: Error: Rate limited
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\chat-error-branches.test.js:170:30)
        at Promise.then.completed (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:316:40)
        at _runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:178:7)

  console.warn
    [2025-11-20T15:32:02.790Z] [WARN] Database operation failed:

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at warn (src/services/chat.js:296:12)
      at processUserMessageStorage (src/services/chat.js:362:11)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:203:7)

  console.warn
    Failed to add user message for user123: Failed to update user stats for user123: table user_stats has no column named username

    [0m [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
     [90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
    [31m[1m>[22m[39m[90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m     |[39m                         [31m[1m^[22m[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m
     [90m 173 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.warn (src/utils/logger.js:170:25)
      at warn (src/services/chat.js:296:12)
      at processUserMessageStorage (src/services/chat.js:362:11)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:203:7)

  console.error
    [2025-11-20T15:32:02.793Z] [ERROR] Error in processAIResponse:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:203:7)

  console.error
    Error: Service error

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:203:7)

  console.error
    Stack: Error: Service error
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\chat-error-branches.test.js:195:24)
        at Promise.then.completed (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:316:40)
        at _runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:203:7)

  console.warn
    [2025-11-20T15:32:02.967Z] [WARN] Database operation failed:

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at warn (src/services/chat.js:296:12)
      at processUserMessageStorage (src/services/chat.js:362:11)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:225:7)

  console.warn
    Failed to add user message for user123: Failed to update user stats for user123: table user_stats has no column named username

    [0m [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
     [90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
    [31m[1m>[22m[39m[90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m     |[39m                         [31m[1m^[22m[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m
     [90m 173 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.warn (src/utils/logger.js:170:25)
      at warn (src/services/chat.js:296:12)
      at processUserMessageStorage (src/services/chat.js:362:11)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:225:7)

  console.warn
    [2025-11-20T15:32:03.155Z] [WARN] Database operation failed:

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at warn (src/services/chat.js:296:12)
      at processUserMessageStorage (src/services/chat.js:362:11)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:236:7)

  console.warn
    Failed to add user message for user123: Failed to update user stats for user123: table user_stats has no column named username

    [0m [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
     [90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
    [31m[1m>[22m[39m[90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m     |[39m                         [31m[1m^[22m[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m
     [90m 173 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.warn (src/utils/logger.js:170:25)
      at warn (src/services/chat.js:296:12)
      at processUserMessageStorage (src/services/chat.js:362:11)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:236:7)

  console.warn
    [2025-11-20T15:32:03.337Z] [WARN] Database operation failed:

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at warn (src/services/chat.js:296:12)
      at processUserMessageStorage (src/services/chat.js:362:11)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:252:7)

  console.warn
    Failed to add user message for user123: Failed to update user stats for user123: table user_stats has no column named username

    [0m [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
     [90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
    [31m[1m>[22m[39m[90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m     |[39m                         [31m[1m^[22m[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m
     [90m 173 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.warn (src/utils/logger.js:170:25)
      at warn (src/services/chat.js:296:12)
      at processUserMessageStorage (src/services/chat.js:362:11)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:252:7)

  console.error
    [2025-11-20T15:32:03.354Z] [ERROR] Error in processAIResponse:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:252:7)

  console.error
    Error: Emoji error

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:252:7)

  console.error
    Stack: Error: Emoji error
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\chat-error-branches.test.js:249:64)
        at Promise.then.completed (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:316:40)
        at _runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:252:7)

  console.warn
    [2025-11-20T15:32:03.525Z] [WARN] Database operation failed:

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at warn (src/services/chat.js:296:12)
      at processUserMessageStorage (src/services/chat.js:362:11)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:267:7)

  console.warn
    Failed to add user message for user123: Failed to update user stats for user123: table user_stats has no column named username

    [0m [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
     [90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
    [31m[1m>[22m[39m[90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m     |[39m                         [31m[1m^[22m[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m
     [90m 173 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.warn (src/utils/logger.js:170:25)
      at warn (src/services/chat.js:296:12)
      at processUserMessageStorage (src/services/chat.js:362:11)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:267:7)

  console.error
    [2025-11-20T15:32:03.529Z] [ERROR] Error in processAIResponse:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:267:7)

  console.error
    Error: Service error

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:267:7)

  console.error
    Stack: Error: Service error
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\chat-error-branches.test.js:261:68)
        at Promise.then.completed (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:316:40)
        at _runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:267:7)

  console.warn
    [2025-11-20T15:32:03.705Z] [WARN] Database operation failed:

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at warn (src/services/chat.js:296:12)
      at processUserMessageStorage (src/services/chat.js:362:11)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:282:7)

  console.warn
    Failed to add user message for user123: Failed to update user stats for user123: table user_stats has no column named username

    [0m [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
     [90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
    [31m[1m>[22m[39m[90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m     |[39m                         [31m[1m^[22m[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m
     [90m 173 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.warn (src/utils/logger.js:170:25)
      at warn (src/services/chat.js:296:12)
      at processUserMessageStorage (src/services/chat.js:362:11)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:282:7)

  console.error
    [2025-11-20T15:32:03.722Z] [ERROR] Error in processAIResponse:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:282:7)

  console.error
    Error: Chunking error

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:282:7)

  console.error
    Stack: Error: Chunking error
        at C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\chat-error-branches.test.js:275:15
        at C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-mock\build\index.js:397:39
        at C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-mock\build\index.js:404:13
        at mockConstructor (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-mock\build\index.js:148:19)
        at chunkMessage (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\chat.js:494:20)
        at handleChatMessage (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\chat.js:372:5)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\chat-error-branches.test.js:282:7)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at error (src/services/chat.js:515:12)
      at handleChatMessage (src/services/chat.js:372:5)
      at Object.<anonymous> (__tests__/unit/chat-error-branches.test.js:282:7)

  console.log
    [2025-11-20T15:32:05.003Z] [INFO] API Request: model="sonar", messages=1, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.009Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.010Z] [INFO] Request payload summary: model=sonar, messages=1, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:32:05.013Z] [ERROR] API request failed for endpoint /chat/completions:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:29:7)

  console.error
    Error: API request failed with status 429: {"error":"Rate limit exceeded"}

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:29:7)

  console.warn
    [2025-11-20T15:32:05.054Z] [WARN] Rate limit error in API call to Perplexity API:

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at Function.warn [as handleError] (src/utils/error-handler.js:189:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:29:7)

  console.warn
    {
      type: 'RATE_LIMIT_ERROR',
      context: 'API call to Perplexity API',
      message: 'API request failed with status 429: {"error":"Rate limit exceeded"}',
      stack: 'Error: API request failed with status 429: {"error":"Rate limit exceeded"}\n' +
        '    at Function.createError (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\src\\utils\\error-handler.js:273:19)\n' +
        '    at ApiClient.createError [as handleErrorResponse] (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\src\\services\\api-client.js:201:32)\n' +
        '    at ApiClient.handleResponse (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\src\\services\\api-client.js:144:7)\n' +
        '    at ApiClient.makeRequest (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\src\\services\\api-client.js:120:14)\n' +
        '    at makeApiRequest (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\src\\services\\perplexity-secure.js:509:14)\n' +
        '    at PerplexityService.sendChatRequest (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\src\\services\\perplexity-secure.js:520:20)\n' +
        '    at Object.<anonymous> (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\__tests__\\unit\\perplexity-service-advanced.test.js:29:7)',
      code: null,
      statusCode: 429,
      timestamp: '2025-11-20T15:32:05.054Z',
      endpoint: 'Perplexity API',
      statusMessage: 'Too Many Requests',
      responseData: undefined
    }

    [0m [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
     [90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
    [31m[1m>[22m[39m[90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m     |[39m                         [31m[1m^[22m[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m
     [90m 173 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.warn (src/utils/logger.js:170:25)
      at Function.warn [as handleError] (src/utils/error-handler.js:189:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:29:7)

  console.error
    [2025-11-20T15:32:05.060Z] [ERROR] API request failed: The service is currently busy. Please wait a moment and try again.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as sendChatRequest] (src/services/perplexity-secure.js:526:14)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:29:7)

  console.log
    [2025-11-20T15:32:05.067Z] [INFO] API Request: model="sonar", messages=1, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.068Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.069Z] [INFO] Request payload summary: model=sonar, messages=1, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:32:05.069Z] [ERROR] API request failed for endpoint /chat/completions:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:39:7)

  console.error
    Error: API request failed with status 500: {"error":"Internal server error"}

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:39:7)

  console.error
    [2025-11-20T15:32:05.079Z] [ERROR] Error in API call to Perplexity API:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:39:7)

  console.error
    Error: API request failed with status 500: {"error":"Internal server error"}

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:39:7)

  console.error
    Stack: Error: API request failed with status 500: {"error":"Internal server error"}
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleErrorResponse] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:201:32)
        at ApiClient.handleResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:144:7)
        at ApiClient.makeRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:120:14)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\perplexity-service-advanced.test.js:39:7)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:39:7)

  console.error
    [2025-11-20T15:32:05.086Z] [ERROR] API request failed: Network connection issue. Please check your connection and try again.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as sendChatRequest] (src/services/perplexity-secure.js:526:14)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:39:7)

  console.log
    [2025-11-20T15:32:05.089Z] [INFO] API Request: model="sonar", messages=1, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.090Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.091Z] [INFO] Request payload summary: model=sonar, messages=1, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:32:05.092Z] [ERROR] API request failed for endpoint /chat/completions:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:49:7)

  console.error
    Error: API request failed with status 401: {"error":"Unauthorized"}

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:49:7)

  console.error
    [2025-11-20T15:32:05.096Z] [ERROR] Error in API call to Perplexity API:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:49:7)

  console.error
    Error: API request failed with status 401: {"error":"Unauthorized"}

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:49:7)

  console.error
    Stack: Error: API request failed with status 401: {"error":"Unauthorized"}
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleErrorResponse] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:201:32)
        at ApiClient.handleResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:144:7)
        at ApiClient.makeRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:120:14)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\perplexity-service-advanced.test.js:49:7)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:49:7)

  console.error
    [2025-11-20T15:32:05.105Z] [ERROR] API request failed: The service is temporarily unavailable. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as sendChatRequest] (src/services/perplexity-secure.js:526:14)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:49:7)

  console.log
    [2025-11-20T15:32:05.107Z] [INFO] API Request: model="sonar", messages=1, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.108Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.109Z] [INFO] Request payload summary: model=sonar, messages=1, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:32:05.109Z] [ERROR] API request failed for endpoint /chat/completions:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:59:7)

  console.error
    Error: API request failed with status 403: {"error":"Forbidden"}

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:59:7)

  console.error
    [2025-11-20T15:32:05.113Z] [ERROR] Error in API call to Perplexity API:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:59:7)

  console.error
    Error: API request failed with status 403: {"error":"Forbidden"}

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:59:7)

  console.error
    Stack: Error: API request failed with status 403: {"error":"Forbidden"}
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleErrorResponse] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:201:32)
        at ApiClient.handleResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:144:7)
        at ApiClient.makeRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:120:14)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\perplexity-service-advanced.test.js:59:7)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:59:7)

  console.error
    [2025-11-20T15:32:05.117Z] [ERROR] API request failed: The service is temporarily unavailable. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as sendChatRequest] (src/services/perplexity-secure.js:526:14)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:59:7)

  console.log
    [2025-11-20T15:32:05.119Z] [INFO] API Request: model="sonar", messages=1, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.119Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.120Z] [INFO] Request payload summary: model=sonar, messages=1, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:32:05.120Z] [ERROR] API request failed for endpoint /chat/completions:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:67:7)

  console.error
    Error: Request timeout

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:67:7)

  console.error
    [2025-11-20T15:32:05.123Z] [ERROR] Error in API call to Perplexity API:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:67:7)

  console.error
    Error: Request failed: Request timeout

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:67:7)

  console.error
    Stack: Error: Request failed: Request timeout
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleRequestError] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:216:25)
        at ApiClient.handleRequestError [as makeRequest] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:124:18)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\perplexity-service-advanced.test.js:67:7)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:67:7)

  console.error
    [2025-11-20T15:32:05.129Z] [ERROR] API request failed: An unexpected error occurred. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as sendChatRequest] (src/services/perplexity-secure.js:526:14)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:67:7)

  console.log
    [2025-11-20T15:32:05.131Z] [INFO] API Request: model="sonar", messages=1, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.132Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.132Z] [INFO] Request payload summary: model=sonar, messages=1, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:32:05.133Z] [ERROR] API request failed for endpoint /chat/completions:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:77:7)

  console.error
    Error: Failed to parse API response: Invalid response: missing or empty choices array

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:77:7)

  console.error
    [2025-11-20T15:32:05.137Z] [ERROR] Error in API call to Perplexity API:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:77:7)

  console.error
    Error: Request failed: Failed to parse API response: Invalid response: missing or empty choices array

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:77:7)

  console.error
    Stack: Error: Request failed: Failed to parse API response: Invalid response: missing or empty choices array
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleRequestError] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:216:25)
        at ApiClient.handleRequestError [as makeRequest] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:124:18)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\perplexity-service-advanced.test.js:77:7)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:77:7)

  console.error
    [2025-11-20T15:32:05.141Z] [ERROR] API request failed: The service is temporarily unavailable. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as sendChatRequest] (src/services/perplexity-secure.js:526:14)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:77:7)

  console.log
    [2025-11-20T15:32:05.143Z] [INFO] API Request: model="sonar", messages=1, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.144Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.144Z] [INFO] Request payload summary: model=sonar, messages=1, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:32:05.145Z] [ERROR] API request failed for endpoint /chat/completions:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:87:7)

  console.error
    Error: Failed to parse API response: Invalid response: missing or empty choices array

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:87:7)

  console.error
    [2025-11-20T15:32:05.148Z] [ERROR] Error in API call to Perplexity API:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:87:7)

  console.error
    Error: Request failed: Failed to parse API response: Invalid response: missing or empty choices array

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:87:7)

  console.error
    Stack: Error: Request failed: Failed to parse API response: Invalid response: missing or empty choices array
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleRequestError] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:216:25)
        at ApiClient.handleRequestError [as makeRequest] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:124:18)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\perplexity-service-advanced.test.js:87:7)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:87:7)

  console.error
    [2025-11-20T15:32:05.152Z] [ERROR] API request failed: The service is temporarily unavailable. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as sendChatRequest] (src/services/perplexity-secure.js:526:14)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:87:7)

  console.log
    [2025-11-20T15:32:05.156Z] [INFO] API Request: model="sonar", messages=1, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.156Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.157Z] [INFO] Request payload summary: model=sonar, messages=1, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:32:05.158Z] [ERROR] API request failed for endpoint /chat/completions:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:97:7)

  console.error
    Error: Failed to parse API response: Invalid response: missing or empty choices array

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:97:7)

  console.error
    [2025-11-20T15:32:05.161Z] [ERROR] Error in API call to Perplexity API:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:97:7)

  console.error
    Error: Request failed: Failed to parse API response: Invalid response: missing or empty choices array

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:97:7)

  console.error
    Stack: Error: Request failed: Failed to parse API response: Invalid response: missing or empty choices array
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleRequestError] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:216:25)
        at ApiClient.handleRequestError [as makeRequest] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:124:18)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\perplexity-service-advanced.test.js:97:7)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:97:7)

  console.error
    [2025-11-20T15:32:05.166Z] [ERROR] API request failed: The service is temporarily unavailable. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as sendChatRequest] (src/services/perplexity-secure.js:526:14)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:97:7)

  console.log
    [2025-11-20T15:32:05.168Z] [INFO] API Request: model="sonar", messages=1, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.170Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.171Z] [INFO] Request payload summary: model=sonar, messages=1, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:32:05.172Z] [ERROR] API request failed for endpoint /chat/completions:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:107:7)

  console.error
    Error: Failed to parse API response: Invalid response: missing content in choices

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:107:7)

  console.error
    [2025-11-20T15:32:05.174Z] [ERROR] Error in API call to Perplexity API:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:107:7)

  console.error
    Error: Request failed: Failed to parse API response: Invalid response: missing content in choices

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:107:7)

  console.error
    Stack: Error: Request failed: Failed to parse API response: Invalid response: missing content in choices
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleRequestError] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:216:25)
        at ApiClient.handleRequestError [as makeRequest] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:124:18)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\perplexity-service-advanced.test.js:107:7)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:107:7)

  console.error
    [2025-11-20T15:32:05.179Z] [ERROR] API request failed: The service is temporarily unavailable. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as sendChatRequest] (src/services/perplexity-secure.js:526:14)
      at Object.<anonymous> (__tests__/unit/perplexity-service-advanced.test.js:107:7)

  console.log
    [2025-11-20T15:32:05.181Z] [INFO] API Request: model="sonar", messages=1, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.182Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.184Z] [INFO] Request payload summary: model=sonar, messages=1, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.186Z] [INFO] API Request: model="sonar", messages=1, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.187Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.187Z] [INFO] Request payload summary: model=sonar, messages=1, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.188Z] [INFO] API Request: model="sonar", messages=1, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.189Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:05.190Z] [INFO] Request payload summary: model=sonar, messages=1, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    TEST: Starting addUserMessage test

      at Object.log (__tests__/unit/services/database-messages.test.js:127:15)

  console.log
    TEST: Database path: C:\Users\chris\aszune-ai\aszune-ai-bot\test-data\bot.db

      at Object.log (__tests__/unit/services/database-messages.test.js:128:15)

  console.log
    TEST: Database file exists before: false

      at Object.log (__tests__/unit/services/database-messages.test.js:129:15)

  console.log
    TEST: DB connection 1: Database {
      name: 'C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\test-data\\bot.db',
      open: true,
      inTransaction: false,
      readonly: false,
      memory: false
    }

      at Object.log (__tests__/unit/services/database-messages.test.js:132:15)

  console.log
    TEST: addUserMessage completed

      at Object.log (__tests__/unit/services/database-messages.test.js:135:15)

  console.log
    TEST: DB connection 2: Database {
      name: 'C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\test-data\\bot.db',
      open: true,
      inTransaction: false,
      readonly: false,
      memory: false
    }

      at Object.log (__tests__/unit/services/database-messages.test.js:138:15)

  console.log
    TEST: Same connection? true

      at Object.log (__tests__/unit/services/database-messages.test.js:139:15)

  console.log
    TEST: Database file exists after: true

      at Object.log (__tests__/unit/services/database-messages.test.js:141:15)

  console.log
    TEST: Database file size: 102400

      at Object.log (__tests__/unit/services/database-messages.test.js:145:17)

  console.log
    TEST: Retrieved messages: [ 'Hello world' ]

      at Object.log (__tests__/unit/services/database-messages.test.js:149:15)

  console.log
    TEST: Raw SQL result: [
      {
        id: 1,
        user_id: '123',
        message: 'Hello world',
        timestamp: '2025-11-20 15:32:37'
      }
    ]

      at Object.log (__tests__/unit/services/database-messages.test.js:154:15)

  console.log
    [2025-11-20T15:32:39.730Z] [INFO] API Request: model="sonar", messages=2, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:39.737Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:39.739Z] [INFO] Request payload summary: model=sonar, messages=2, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:32:39.741Z] [ERROR] API request failed for endpoint /chat/completions:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:52:7)

  console.error
    Error: API request failed with status 429: {"error":"Rate limit exceeded"}

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:52:7)

  console.warn
    [2025-11-20T15:32:39.794Z] [WARN] Rate limit error in API call to Perplexity API:

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at Function.warn [as handleError] (src/utils/error-handler.js:189:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:52:7)

  console.warn
    {
      type: 'RATE_LIMIT_ERROR',
      context: 'API call to Perplexity API',
      message: 'API request failed with status 429: {"error":"Rate limit exceeded"}',
      stack: 'Error: API request failed with status 429: {"error":"Rate limit exceeded"}\n' +
        '    at Function.createError (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\src\\utils\\error-handler.js:273:19)\n' +
        '    at ApiClient.createError [as handleErrorResponse] (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\src\\services\\api-client.js:201:32)\n' +
        '    at ApiClient.handleResponse (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\src\\services\\api-client.js:144:7)\n' +
        '    at ApiClient.makeRequest (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\src\\services\\api-client.js:120:14)\n' +
        '    at makeApiRequest (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\src\\services\\perplexity-secure.js:509:14)\n' +
        '    at PerplexityService.sendChatRequest (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\src\\services\\perplexity-secure.js:520:20)\n' +
        '    at ResponseProcessor.generateResponseWithRetry (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\src\\services\\response-processor.js:135:14)\n' +
        '    at PerplexityService._processChatResponse (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\src\\services\\perplexity-secure.js:754:22)\n' +
        '    at PerplexityService.generateChatResponse (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\src\\services\\perplexity-secure.js:815:23)\n' +
        '    at Object.<anonymous> (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\__tests__\\unit\\services\\perplexity-secure-core.test.js:52:7)',
      code: null,
      statusCode: 429,
      timestamp: '2025-11-20T15:32:39.794Z',
      endpoint: 'Perplexity API',
      statusMessage: 'Too Many Requests',
      responseData: undefined
    }

    [0m [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
     [90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
    [31m[1m>[22m[39m[90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m     |[39m                         [31m[1m^[22m[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m
     [90m 173 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.warn (src/utils/logger.js:170:25)
      at Function.warn [as handleError] (src/utils/error-handler.js:189:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:52:7)

  console.error
    [2025-11-20T15:32:39.799Z] [ERROR] API request failed: The service is currently busy. Please wait a moment and try again.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as sendChatRequest] (src/services/perplexity-secure.js:526:14)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:52:7)

  console.warn
    [2025-11-20T15:32:39.819Z] [WARN] Rate limit error in generate chat response:

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at Function.warn [as handleError] (src/utils/error-handler.js:189:14)
      at PerplexityService.handleError [as generateChatResponse] (src/services/perplexity-secure.js:842:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:52:7)

  console.warn
    {
      type: 'RATE_LIMIT_ERROR',
      context: 'generate chat response',
      message: 'API request failed with status 429: {"error":"Rate limit exceeded"}',
      stack: 'Error: API request failed with status 429: {"error":"Rate limit exceeded"}\n' +
        '    at Function.createError (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\src\\utils\\error-handler.js:273:19)\n' +
        '    at ApiClient.createError [as handleErrorResponse] (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\src\\services\\api-client.js:201:32)\n' +
        '    at ApiClient.handleResponse (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\src\\services\\api-client.js:144:7)\n' +
        '    at ApiClient.makeRequest (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\src\\services\\api-client.js:120:14)\n' +
        '    at makeApiRequest (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\src\\services\\perplexity-secure.js:509:14)\n' +
        '    at PerplexityService.sendChatRequest (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\src\\services\\perplexity-secure.js:520:20)\n' +
        '    at ResponseProcessor.generateResponseWithRetry (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\src\\services\\response-processor.js:135:14)\n' +
        '    at PerplexityService._processChatResponse (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\src\\services\\perplexity-secure.js:754:22)\n' +
        '    at PerplexityService.generateChatResponse (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\src\\services\\perplexity-secure.js:815:23)\n' +
        '    at Object.<anonymous> (C:\\Users\\chris\\aszune-ai\\aszune-ai-bot\\__tests__\\unit\\services\\perplexity-secure-core.test.js:52:7)',
      code: null,
      statusCode: 429,
      timestamp: '2025-11-20T15:32:39.819Z',
      historyLength: 1,
      shouldUseCache: true
    }

    [0m [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
     [90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
    [31m[1m>[22m[39m[90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m     |[39m                         [31m[1m^[22m[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m
     [90m 173 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.warn (src/utils/logger.js:170:25)
      at Function.warn [as handleError] (src/utils/error-handler.js:189:14)
      at PerplexityService.handleError [as generateChatResponse] (src/services/perplexity-secure.js:842:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:52:7)

  console.error
    [2025-11-20T15:32:39.824Z] [ERROR] Failed to generate chat response: The service is currently busy. Please wait a moment and try again.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as generateChatResponse] (src/services/perplexity-secure.js:846:14)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:52:7)

  console.log
    [2025-11-20T15:32:39.828Z] [INFO] API Request: model="sonar", messages=2, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:39.829Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:39.830Z] [INFO] Request payload summary: model=sonar, messages=2, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:32:39.832Z] [ERROR] API request failed for endpoint /chat/completions:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:62:7)

  console.error
    Error: API request failed with status 500: {"error":"API Error"}

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:62:7)

  console.error
    [2025-11-20T15:32:39.838Z] [ERROR] Error in API call to Perplexity API:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:62:7)

  console.error
    Error: API request failed with status 500: {"error":"API Error"}

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:62:7)

  console.error
    Stack: Error: API request failed with status 500: {"error":"API Error"}
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleErrorResponse] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:201:32)
        at ApiClient.handleResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:144:7)
        at ApiClient.makeRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:120:14)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at ResponseProcessor.generateResponseWithRetry (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\response-processor.js:135:14)
        at PerplexityService._processChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:754:22)
        at PerplexityService.generateChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:815:23)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-core.test.js:62:7)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:62:7)

  console.error
    [2025-11-20T15:32:39.845Z] [ERROR] API request failed: Network connection issue. Please check your connection and try again.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as sendChatRequest] (src/services/perplexity-secure.js:526:14)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:62:7)

  console.error
    [2025-11-20T15:32:39.861Z] [ERROR] Error in generate chat response:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as generateChatResponse] (src/services/perplexity-secure.js:842:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:62:7)

  console.error
    Error: API request failed with status 500: {"error":"API Error"}

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as generateChatResponse] (src/services/perplexity-secure.js:842:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:62:7)

  console.error
    Stack: Error: API request failed with status 500: {"error":"API Error"}
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleErrorResponse] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:201:32)
        at ApiClient.handleResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:144:7)
        at ApiClient.makeRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:120:14)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at ResponseProcessor.generateResponseWithRetry (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\response-processor.js:135:14)
        at PerplexityService._processChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:754:22)
        at PerplexityService.generateChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:815:23)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-core.test.js:62:7)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as generateChatResponse] (src/services/perplexity-secure.js:842:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:62:7)

  console.error
    [2025-11-20T15:32:39.870Z] [ERROR] Failed to generate chat response: Network connection issue. Please check your connection and try again.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as generateChatResponse] (src/services/perplexity-secure.js:846:14)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:62:7)

  console.log
    [2025-11-20T15:32:39.873Z] [INFO] API Request: model="sonar", messages=2, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:39.875Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:39.876Z] [INFO] Request payload summary: model=sonar, messages=2, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:32:39.877Z] [ERROR] API request failed for endpoint /chat/completions:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:72:7)

  console.error
    Error: Network error

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:72:7)

  console.error
    [2025-11-20T15:32:39.883Z] [ERROR] Error in API call to Perplexity API:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:72:7)

  console.error
    Error: Request failed: Network error

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:72:7)

  console.error
    Stack: Error: Request failed: Network error
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleRequestError] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:216:25)
        at ApiClient.handleRequestError [as makeRequest] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:124:18)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at ResponseProcessor.generateResponseWithRetry (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\response-processor.js:135:14)
        at PerplexityService._processChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:754:22)
        at PerplexityService.generateChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:815:23)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-core.test.js:72:7)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:72:7)

  console.error
    [2025-11-20T15:32:39.890Z] [ERROR] API request failed: An unexpected error occurred. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as sendChatRequest] (src/services/perplexity-secure.js:526:14)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:72:7)

  console.error
    [2025-11-20T15:32:39.907Z] [ERROR] Error in generate chat response:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as generateChatResponse] (src/services/perplexity-secure.js:842:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:72:7)

  console.error
    Error: Request failed: Network error

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as generateChatResponse] (src/services/perplexity-secure.js:842:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:72:7)

  console.error
    Stack: Error: Request failed: Network error
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleRequestError] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:216:25)
        at ApiClient.handleRequestError [as makeRequest] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:124:18)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at ResponseProcessor.generateResponseWithRetry (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\response-processor.js:135:14)
        at PerplexityService._processChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:754:22)
        at PerplexityService.generateChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:815:23)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-core.test.js:72:7)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as generateChatResponse] (src/services/perplexity-secure.js:842:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:72:7)

  console.error
    [2025-11-20T15:32:39.915Z] [ERROR] Failed to generate chat response: An unexpected error occurred. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as generateChatResponse] (src/services/perplexity-secure.js:846:14)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:72:7)

  console.log
    [2025-11-20T15:32:39.918Z] [INFO] API Request: model="sonar", messages=2, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:39.919Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:39.921Z] [INFO] Request payload summary: model=sonar, messages=2, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:32:39.922Z] [ERROR] API request failed for endpoint /chat/completions:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:82:7)

  console.error
    Error: Failed to parse API response: Invalid response: missing or empty choices array

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:82:7)

  console.error
    [2025-11-20T15:32:39.926Z] [ERROR] Error in API call to Perplexity API:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:82:7)

  console.error
    Error: Request failed: Failed to parse API response: Invalid response: missing or empty choices array

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:82:7)

  console.error
    Stack: Error: Request failed: Failed to parse API response: Invalid response: missing or empty choices array
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleRequestError] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:216:25)
        at ApiClient.handleRequestError [as makeRequest] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:124:18)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at ResponseProcessor.generateResponseWithRetry (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\response-processor.js:135:14)
        at PerplexityService._processChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:754:22)
        at PerplexityService.generateChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:815:23)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-core.test.js:82:7)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:82:7)

  console.error
    [2025-11-20T15:32:39.933Z] [ERROR] API request failed: The service is temporarily unavailable. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as sendChatRequest] (src/services/perplexity-secure.js:526:14)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:82:7)

  console.error
    [2025-11-20T15:32:39.949Z] [ERROR] Error in generate chat response:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as generateChatResponse] (src/services/perplexity-secure.js:842:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:82:7)

  console.error
    Error: Request failed: Failed to parse API response: Invalid response: missing or empty choices array

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as generateChatResponse] (src/services/perplexity-secure.js:842:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:82:7)

  console.error
    Stack: Error: Request failed: Failed to parse API response: Invalid response: missing or empty choices array
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleRequestError] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:216:25)
        at ApiClient.handleRequestError [as makeRequest] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:124:18)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at ResponseProcessor.generateResponseWithRetry (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\response-processor.js:135:14)
        at PerplexityService._processChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:754:22)
        at PerplexityService.generateChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:815:23)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-core.test.js:82:7)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as generateChatResponse] (src/services/perplexity-secure.js:842:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:82:7)

  console.error
    [2025-11-20T15:32:39.954Z] [ERROR] Failed to generate chat response: The service is temporarily unavailable. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as generateChatResponse] (src/services/perplexity-secure.js:846:14)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:82:7)

  console.log
    [2025-11-20T15:32:39.959Z] [INFO] API Request: model="sonar", messages=2, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:39.961Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:39.962Z] [INFO] Request payload summary: model=sonar, messages=2, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:32:39.963Z] [ERROR] API request failed for endpoint /chat/completions:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:92:7)

  console.error
    Error: Failed to parse API response: Invalid response: missing or empty choices array

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:92:7)

  console.error
    [2025-11-20T15:32:39.969Z] [ERROR] Error in API call to Perplexity API:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:92:7)

  console.error
    Error: Request failed: Failed to parse API response: Invalid response: missing or empty choices array

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:92:7)

  console.error
    Stack: Error: Request failed: Failed to parse API response: Invalid response: missing or empty choices array
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleRequestError] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:216:25)
        at ApiClient.handleRequestError [as makeRequest] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:124:18)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at ResponseProcessor.generateResponseWithRetry (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\response-processor.js:135:14)
        at PerplexityService._processChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:754:22)
        at PerplexityService.generateChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:815:23)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-core.test.js:92:7)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:92:7)

  console.error
    [2025-11-20T15:32:39.974Z] [ERROR] API request failed: The service is temporarily unavailable. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as sendChatRequest] (src/services/perplexity-secure.js:526:14)
      at ResponseProcessor.generateResponseWithRetry (src/services/response-processor.js:135:14)
      at PerplexityService._processChatResponse (src/services/perplexity-secure.js:754:22)
      at PerplexityService.generateChatResponse (src/services/perplexity-secure.js:815:23)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:92:7)

  console.error
    [2025-11-20T15:32:39.988Z] [ERROR] Error in generate chat response:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as generateChatResponse] (src/services/perplexity-secure.js:842:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:92:7)

  console.error
    Error: Request failed: Failed to parse API response: Invalid response: missing or empty choices array

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as generateChatResponse] (src/services/perplexity-secure.js:842:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:92:7)

  console.error
    Stack: Error: Request failed: Failed to parse API response: Invalid response: missing or empty choices array
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleRequestError] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:216:25)
        at ApiClient.handleRequestError [as makeRequest] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:124:18)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at ResponseProcessor.generateResponseWithRetry (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\response-processor.js:135:14)
        at PerplexityService._processChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:754:22)
        at PerplexityService.generateChatResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:815:23)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-core.test.js:92:7)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as generateChatResponse] (src/services/perplexity-secure.js:842:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:92:7)

  console.error
    [2025-11-20T15:32:39.994Z] [ERROR] Failed to generate chat response: The service is temporarily unavailable. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as generateChatResponse] (src/services/perplexity-secure.js:846:14)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:92:7)

  console.log
    [2025-11-20T15:32:39.997Z] [INFO] API Request: model="sonar", messages=2, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:39.998Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:39.998Z] [INFO] Request payload summary: model=sonar, messages=2, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:40.019Z] [INFO] API Request: model="sonar", messages=2, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:40.020Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:40.021Z] [INFO] Request payload summary: model=sonar, messages=2, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:40.038Z] [INFO] API Request: model="sonar", messages=2, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:40.039Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:40.040Z] [INFO] Request payload summary: model=sonar, messages=2, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:40.056Z] [INFO] API Request: model="sonar", messages=2, temperature=0.2, max_tokens=256

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:40.057Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:40.058Z] [INFO] Request payload summary: model=sonar, messages=2, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:32:40.059Z] [ERROR] Invalid message format detected:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at ApiClient.error [as buildRequestPayload] (src/services/api-client.js:54:14)
      at PerplexityService.buildRequestPayload [as sendChatRequest] (src/services/perplexity-secure.js:505:43)
      at PerplexityService.sendChatRequest [as generateTextSummary] (src/services/perplexity-secure.js:1061:33)
      at PerplexityService.generateTextSummary [as generateSummary] (src/services/perplexity-secure.js:1029:25)
      at Object.generateSummary (__tests__/unit/services/perplexity-secure-core.test.js:175:46)

  console.error
    Error: [{"role":"user","content":""}]

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at ApiClient.error [as buildRequestPayload] (src/services/api-client.js:54:14)
      at PerplexityService.buildRequestPayload [as sendChatRequest] (src/services/perplexity-secure.js:505:43)
      at PerplexityService.sendChatRequest [as generateTextSummary] (src/services/perplexity-secure.js:1061:33)
      at PerplexityService.generateTextSummary [as generateSummary] (src/services/perplexity-secure.js:1029:25)
      at Object.generateSummary (__tests__/unit/services/perplexity-secure-core.test.js:175:46)

  console.error
    [2025-11-20T15:32:40.066Z] [ERROR] Error in generate summary:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as generateSummary] (src/services/perplexity-secure.js:1031:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:175:22)

  console.error
    Error: All messages must have role and content fields

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as generateSummary] (src/services/perplexity-secure.js:1031:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:175:22)

  console.error
    Stack: Error: All messages must have role and content fields
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as buildRequestPayload] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:55:26)
        at PerplexityService.buildRequestPayload [as sendChatRequest] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:505:43)
        at PerplexityService.sendChatRequest [as generateTextSummary] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:1061:33)
        at PerplexityService.generateTextSummary [as generateSummary] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:1029:25)
        at Object.generateSummary (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-core.test.js:175:46)
        at Promise.then.completed (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:316:40)
        at _runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as generateSummary] (src/services/perplexity-secure.js:1031:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:175:22)

  console.error
    [2025-11-20T15:32:40.071Z] [ERROR] Failed to generate summary: An unexpected error occurred. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as generateSummary] (src/services/perplexity-secure.js:1035:14)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:175:22)

  console.log
    [2025-11-20T15:32:40.074Z] [INFO] API Request: model="sonar", messages=2, temperature=0.2, max_tokens=256

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:40.075Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:32:40.076Z] [INFO] Request payload summary: model=sonar, messages=2, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:32:40.077Z] [ERROR] API request failed for endpoint /chat/completions:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at PerplexityService.generateTextSummary (src/services/perplexity-secure.js:1061:22)
      at PerplexityService.generateSummary (src/services/perplexity-secure.js:1029:14)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:183:22)

  console.error
    Error: Summary generation failed

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at PerplexityService.generateTextSummary (src/services/perplexity-secure.js:1061:22)
      at PerplexityService.generateSummary (src/services/perplexity-secure.js:1029:14)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:183:22)

  console.error
    [2025-11-20T15:32:40.081Z] [ERROR] Error in API call to Perplexity API:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at PerplexityService.generateTextSummary (src/services/perplexity-secure.js:1061:22)
      at PerplexityService.generateSummary (src/services/perplexity-secure.js:1029:14)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:183:22)

  console.error
    Error: Request failed: Summary generation failed

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at PerplexityService.generateTextSummary (src/services/perplexity-secure.js:1061:22)
      at PerplexityService.generateSummary (src/services/perplexity-secure.js:1029:14)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:183:22)

  console.error
    Stack: Error: Request failed: Summary generation failed
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleRequestError] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:216:25)
        at ApiClient.handleRequestError [as makeRequest] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:124:18)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at PerplexityService.generateTextSummary (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:1061:22)
        at PerplexityService.generateSummary (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:1029:14)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-core.test.js:183:22)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at PerplexityService.generateTextSummary (src/services/perplexity-secure.js:1061:22)
      at PerplexityService.generateSummary (src/services/perplexity-secure.js:1029:14)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:183:22)

  console.error
    [2025-11-20T15:32:40.089Z] [ERROR] API request failed: An unexpected error occurred. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as sendChatRequest] (src/services/perplexity-secure.js:526:14)
      at PerplexityService.generateTextSummary (src/services/perplexity-secure.js:1061:22)
      at PerplexityService.generateSummary (src/services/perplexity-secure.js:1029:14)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:183:22)

  console.error
    [2025-11-20T15:32:40.092Z] [ERROR] Error in generate summary:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as generateSummary] (src/services/perplexity-secure.js:1031:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:183:22)

  console.error
    Error: Request failed: Summary generation failed

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as generateSummary] (src/services/perplexity-secure.js:1031:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:183:22)

  console.error
    Stack: Error: Request failed: Summary generation failed
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleRequestError] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:216:25)
        at ApiClient.handleRequestError [as makeRequest] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:124:18)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at PerplexityService.generateTextSummary (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:1061:22)
        at PerplexityService.generateSummary (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:1029:14)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-core.test.js:183:22)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as generateSummary] (src/services/perplexity-secure.js:1031:42)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:183:22)

  console.error
    [2025-11-20T15:32:40.097Z] [ERROR] Failed to generate summary: An unexpected error occurred. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as generateSummary] (src/services/perplexity-secure.js:1035:14)
      at Object.<anonymous> (__tests__/unit/services/perplexity-secure-core.test.js:183:22)

  console.warn
    [2025-11-20T15:32:43.600Z] [WARN] Failed to log error: SQLite3 can only bind numbers, strings, bigints, buffers, and null

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at DatabaseService.warn [as logError] (src/services/database.js:395:14)
      at Object.logError (__tests__/unit/services/database-analytics.test.js:190:17)

  console.warn
    [2025-11-20T15:32:43.610Z] [WARN] Failed to log error: SQLite3 can only bind numbers, strings, bigints, buffers, and null

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at DatabaseService.warn [as logError] (src/services/database.js:395:14)
      at logError (__tests__/unit/services/database-analytics.test.js:193:30)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.toThrow (__tests__/unit/services/database-analytics.test.js:193:76)

  console.log
    All messages in DB: [
      'Message 0',  'Message 1',
      'Message 2',  'Message 3',
      'Message 4',  'Message 5',
      'Message 6',  'Message 7',
      'Message 8',  'Message 9',
      'Message 10', 'Message 11',
      'Message 12', 'Message 13',
      'Message 14', 'Message 15',
      'Message 16', 'Message 17',
      'Message 18', 'Message 19'
    ]

      at Object.log (__tests__/unit/services/database-conversation.test.js:93:15)

  console.error
    [2025-11-20T15:33:53.648Z] [ERROR] Error in extracting response content:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as _extractResponseContent] (src/services/perplexity-secure.js:491:42)
      at _extractResponseContent (__tests__/unit/services/perplexity-secure-content-extraction.test.js:50:38)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.toThrow (__tests__/unit/services/perplexity-secure-content-extraction.test.js:50:69)

  console.error
    Error: Empty response received from the service.

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as _extractResponseContent] (src/services/perplexity-secure.js:491:42)
      at _extractResponseContent (__tests__/unit/services/perplexity-secure-content-extraction.test.js:50:38)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.toThrow (__tests__/unit/services/perplexity-secure-content-extraction.test.js:50:69)

  console.error
    Stack: Error: Empty response received from the service.
        at PerplexityService._extractResponseContent (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:469:15)
        at _extractResponseContent (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-content-extraction.test.js:50:38)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\expect\build\toThrowMatchers.js:74:11)
        at Object.throwingMatcher [as toThrow] (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\expect\build\index.js:320:21)
        at Object.toThrow (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-content-extraction.test.js:50:69)
        at Promise.then.completed (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:316:40)
        at _runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as _extractResponseContent] (src/services/perplexity-secure.js:491:42)
      at _extractResponseContent (__tests__/unit/services/perplexity-secure-content-extraction.test.js:50:38)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.toThrow (__tests__/unit/services/perplexity-secure-content-extraction.test.js:50:69)

  console.warn
    [2025-11-20T15:33:53.662Z] [WARN] Response processing error: An unexpected error occurred. Please try again later.

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at PerplexityService.warn [as _extractResponseContent] (src/services/perplexity-secure.js:492:14)
      at _extractResponseContent (__tests__/unit/services/perplexity-secure-content-extraction.test.js:50:38)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.toThrow (__tests__/unit/services/perplexity-secure-content-extraction.test.js:50:69)

  console.error
    [2025-11-20T15:33:53.665Z] [ERROR] Error in extracting response content:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as _extractResponseContent] (src/services/perplexity-secure.js:491:42)
      at _extractResponseContent (__tests__/unit/services/perplexity-secure-content-extraction.test.js:55:38)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.toThrow (__tests__/unit/services/perplexity-secure-content-extraction.test.js:55:73)

  console.error
    Error: Empty response received from the service.

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as _extractResponseContent] (src/services/perplexity-secure.js:491:42)
      at _extractResponseContent (__tests__/unit/services/perplexity-secure-content-extraction.test.js:55:38)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.toThrow (__tests__/unit/services/perplexity-secure-content-extraction.test.js:55:73)

  console.error
    Stack: Error: Empty response received from the service.
        at PerplexityService._extractResponseContent (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:474:15)
        at _extractResponseContent (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-content-extraction.test.js:55:38)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\expect\build\toThrowMatchers.js:74:11)
        at Object.throwingMatcher [as toThrow] (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\expect\build\index.js:320:21)
        at Object.toThrow (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\services\perplexity-secure-content-extraction.test.js:55:73)
        at Promise.then.completed (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:316:40)
        at _runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at PerplexityService.handleError [as _extractResponseContent] (src/services/perplexity-secure.js:491:42)
      at _extractResponseContent (__tests__/unit/services/perplexity-secure-content-extraction.test.js:55:38)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.toThrow (__tests__/unit/services/perplexity-secure-content-extraction.test.js:55:73)

  console.warn
    [2025-11-20T15:33:53.674Z] [WARN] Response processing error: An unexpected error occurred. Please try again later.

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at PerplexityService.warn [as _extractResponseContent] (src/services/perplexity-secure.js:492:14)
      at _extractResponseContent (__tests__/unit/services/perplexity-secure-content-extraction.test.js:55:38)
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.toThrow (__tests__/unit/services/perplexity-secure-content-extraction.test.js:55:73)

  console.warn
    [2025-11-20T15:34:03.414Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:62:27)

  console.warn
    [2025-11-20T15:34:03.430Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:70:27)

  console.warn
    [2025-11-20T15:34:03.434Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:84:29)

  console.warn
    [2025-11-20T15:34:03.436Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:84:29)

  console.warn
    [2025-11-20T15:34:03.439Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:84:29)

  console.warn
    [2025-11-20T15:34:03.442Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:84:29)

  console.warn
    [2025-11-20T15:34:03.444Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:84:29)

  console.warn
    [2025-11-20T15:34:03.447Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:84:29)

  console.warn
    [2025-11-20T15:34:03.452Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:84:29)

  console.warn
    [2025-11-20T15:34:03.455Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:84:29)

  console.warn
    [2025-11-20T15:34:03.457Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:84:29)

  console.warn
    [2025-11-20T15:34:03.460Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:84:29)

  console.warn
    [2025-11-20T15:34:03.463Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:84:29)

  console.warn
    [2025-11-20T15:34:03.465Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:84:29)

  console.warn
    [2025-11-20T15:34:03.468Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:84:29)

  console.warn
    [2025-11-20T15:34:03.471Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:84:29)

  console.warn
    [2025-11-20T15:34:03.473Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:84:29)

  console.warn
    [2025-11-20T15:34:03.476Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:84:29)

  console.warn
    [2025-11-20T15:34:03.479Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:84:29)

  console.warn
    [2025-11-20T15:34:03.481Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:84:29)

  console.warn
    [2025-11-20T15:34:03.486Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:84:29)

  console.warn
    [2025-11-20T15:34:03.489Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:84:29)

  console.warn
    [2025-11-20T15:34:03.491Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:84:29)

  console.warn
    [2025-11-20T15:34:03.493Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:84:29)

  console.warn
    [2025-11-20T15:34:03.495Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:84:29)

  console.warn
    [2025-11-20T15:34:03.497Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:84:29)

  console.warn
    [2025-11-20T15:34:03.499Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:84:29)

  console.warn
    [2025-11-20T15:34:03.502Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:98:27)

  console.warn
    [2025-11-20T15:34:03.506Z] [WARN] Failed to update user stats in database: Failed to update user stats for 123456789012345678: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:111:27)

  console.warn
    [2025-11-20T15:34:03.508Z] [WARN] Failed to update user stats in database: Failed to update user stats for 987654321098765432: table user_stats has no column named username

    [0m [90m 167 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mWARN[39m) {
     [90m 168 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'WARN'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 169 |[39m       console[33m.[39mwarn(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 170 |[39m       [36mif[39m (data) console[33m.[39mwarn(data)[33m;[39m
     [90m 171 |[39m
     [90m 172 |[39m       [90m// Write to file[39m[0m

      at Logger.warn (src/utils/logger.js:169:15)
      at ConversationManager.warn [as updateUserStats] (src/utils/conversation.js:282:14)
      at ConversationManager.updateUserStats [as addMessage] (src/utils/conversation.js:199:10)
      at Object.addMessage (__tests__/unit/conversation-manager-basic.test.js:112:27)

  console.log
    [2025-11-20T15:34:51.599Z] [INFO] Final user stats saved before shutdown

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:34:51.602Z] [INFO] Final user stats saved before shutdown

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:34:51.603Z] [INFO] Auto-clearing conversation for user 123456789012345678 after 20 minutes of inactivity

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:34:51.608Z] [INFO] Auto-clearing conversation for user 123456789012345678 after 20 minutes of inactivity

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:34:51.620Z] [ERROR] Error in File saving user stats during shutdown:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleFileError] (src/utils/error-handler.js:244:17)
      at ConversationManager.handleFileError [as destroy] (src/utils/conversation.js:336:42)
      at Object.<anonymous> (__tests__/unit/conversation-manager-advanced.test.js:119:7)

  console.error
    Error: Save failed

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleFileError] (src/utils/error-handler.js:244:17)
      at ConversationManager.handleFileError [as destroy] (src/utils/conversation.js:336:42)
      at Object.<anonymous> (__tests__/unit/conversation-manager-advanced.test.js:119:7)

  console.error
    Stack: Error: Save failed
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\conversation-manager-advanced.test.js:116:42)
        at Promise.then.completed (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:298:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\utils.js:231:10)
        at _callCircusTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:316:40)
        at _runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:252:3)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:126:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at _runTestsForDescribeBlock (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:121:9)
        at run (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\run.js:71:3)
        at runAndTransformResultsToJestFormat (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapterInit.js:122:21)
        at jestAdapter (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-circus\build\legacy-code-todo-rewrite\jestAdapter.js:79:19)
        at runTestInternal (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:367:16)
        at runTest (C:\Users\chris\aszune-ai\aszune-ai-bot\node_modules\jest-runner\build\runTest.js:444:34)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleFileError] (src/utils/error-handler.js:244:17)
      at ConversationManager.handleFileError [as destroy] (src/utils/conversation.js:336:42)
      at Object.<anonymous> (__tests__/unit/conversation-manager-advanced.test.js:119:7)

  console.error
    [2025-11-20T15:34:51.630Z] [ERROR] Failed to save user stats during shutdown: An unexpected error occurred. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at ConversationManager.error [as destroy] (src/utils/conversation.js:341:14)
      at Object.<anonymous> (__tests__/unit/conversation-manager-advanced.test.js:119:7)

  console.log
    [2025-11-20T15:35:07.157Z] [INFO] API Request: model="sonar", messages=1, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:35:07.161Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:35:07.163Z] [INFO] Request payload summary: model=sonar, messages=1, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:35:07.166Z] [INFO] API Request: model="sonar", messages=1, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:35:07.170Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:35:07.171Z] [INFO] Request payload summary: model=sonar, messages=1, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:35:07.172Z] [ERROR] API 400 Error - Bad Request. Response: {"error":"Bad request"}

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at ApiClient.error [as handleErrorResponse] (src/services/api-client.js:193:14)
      at ApiClient.handleResponse (src/services/api-client.js:144:7)
      at ApiClient.makeRequest (src/services/api-client.js:120:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at Object.<anonymous> (__tests__/unit/perplexity-service-basic.test.js:55:7)

  console.error
    [2025-11-20T15:35:07.177Z] [ERROR] API request failed for endpoint /chat/completions:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at Object.<anonymous> (__tests__/unit/perplexity-service-basic.test.js:55:7)

  console.error
    Error: API request failed with status 400: {"error":"Bad request"}

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at Object.<anonymous> (__tests__/unit/perplexity-service-basic.test.js:55:7)

  console.error
    [2025-11-20T15:35:07.223Z] [ERROR] Error in API call to Perplexity API:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-basic.test.js:55:7)

  console.error
    Error: API request failed with status 400: {"error":"Bad request"}

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-basic.test.js:55:7)

  console.error
    Stack: Error: API request failed with status 400: {"error":"Bad request"}
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleErrorResponse] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:201:32)
        at ApiClient.handleResponse (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:144:7)
        at ApiClient.makeRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:120:14)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\perplexity-service-basic.test.js:55:7)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-basic.test.js:55:7)

  console.error
    [2025-11-20T15:35:07.230Z] [ERROR] API request failed: The service is temporarily unavailable. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as sendChatRequest] (src/services/perplexity-secure.js:526:14)
      at Object.<anonymous> (__tests__/unit/perplexity-service-basic.test.js:55:7)

  console.log
    [2025-11-20T15:35:07.233Z] [INFO] API Request: model="sonar", messages=1, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:35:07.234Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:35:07.235Z] [INFO] Request payload summary: model=sonar, messages=1, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.error
    [2025-11-20T15:35:07.236Z] [ERROR] API request failed for endpoint /chat/completions:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at Object.<anonymous> (__tests__/unit/perplexity-service-basic.test.js:63:7)

  console.error
    Error: Network error

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at ApiClient.error [as makeRequest] (src/services/api-client.js:123:14)
      at makeApiRequest (src/services/perplexity-secure.js:509:14)
      at PerplexityService.sendChatRequest (src/services/perplexity-secure.js:520:20)
      at Object.<anonymous> (__tests__/unit/perplexity-service-basic.test.js:63:7)

  console.error
    [2025-11-20T15:35:07.243Z] [ERROR] Error in API call to Perplexity API:

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-basic.test.js:63:7)

  console.error
    Error: Request failed: Network error

    [0m [90m 218 |[39m             stack[33m:[39m error[33m.[39mstack[33m,[39m
     [90m 219 |[39m           }[33m;[39m
    [31m[1m>[22m[39m[90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m 222 |[39m         }
     [90m 223 |[39m[0m

      at Logger.error (src/utils/logger.js:220:19)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-basic.test.js:63:7)

  console.error
    Stack: Error: Request failed: Network error
        at Function.createError (C:\Users\chris\aszune-ai\aszune-ai-bot\src\utils\error-handler.js:273:19)
        at ApiClient.createError [as handleRequestError] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:216:25)
        at ApiClient.handleRequestError [as makeRequest] (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\api-client.js:124:18)
        at makeApiRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:509:14)
        at PerplexityService.sendChatRequest (C:\Users\chris\aszune-ai\aszune-ai-bot\src\services\perplexity-secure.js:520:20)
        at Object.<anonymous> (C:\Users\chris\aszune-ai\aszune-ai-bot\__tests__\unit\perplexity-service-basic.test.js:63:7)

    [0m [90m 219 |[39m           }[33m;[39m
     [90m 220 |[39m           console[33m.[39merror([32m'Error:'[39m[33m,[39m error[33m.[39mmessage [33m||[39m error)[33m;[39m
    [31m[1m>[22m[39m[90m 221 |[39m           [36mif[39m (error[33m.[39mstack) console[33m.[39merror([32m'Stack:'[39m[33m,[39m error[33m.[39mstack)[33m;[39m
     [90m     |[39m                                    [31m[1m^[22m[39m
     [90m 222 |[39m         }
     [90m 223 |[39m
     [90m 224 |[39m         [90m// Write error details to file[39m[0m

      at Logger.error (src/utils/logger.js:221:36)
      at Function.error [as handleError] (src/utils/error-handler.js:193:14)
      at Function.handleError [as handleApiError] (src/utils/error-handler.js:226:17)
      at PerplexityService.handleApiError [as sendChatRequest] (src/services/perplexity-secure.js:525:42)
      at Object.<anonymous> (__tests__/unit/perplexity-service-basic.test.js:63:7)

  console.error
    [2025-11-20T15:35:07.247Z] [ERROR] API request failed: An unexpected error occurred. Please try again later.

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at PerplexityService.error [as sendChatRequest] (src/services/perplexity-secure.js:526:14)
      at Object.<anonymous> (__tests__/unit/perplexity-service-basic.test.js:63:7)

  console.error
    [2025-11-20T15:35:07.250Z] [ERROR] Empty messages array provided to buildRequestPayload

    [0m [90m 184 |[39m     [36mif[39m ([36mthis[39m[33m.[39m_getLogLevel() [33m<=[39m [36mthis[39m[33m.[39mlevels[33m.[39m[33mERROR[39m) {
     [90m 185 |[39m       [36mconst[39m formattedMessage [33m=[39m [36mthis[39m[33m.[39m_formatMessage([32m'ERROR'[39m[33m,[39m message)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m       console[33m.[39merror(formattedMessage)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 187 |[39m
     [90m 188 |[39m       [90m// Write to file[39m
     [90m 189 |[39m       [36mthis[39m[33m.[39m_writeToFile(formattedMessage)[33m;[39m[0m

      at Logger.error (src/utils/logger.js:186:15)
      at ApiClient.error [as buildRequestPayload] (src/services/api-client.js:44:14)
      at PerplexityService.buildRequestPayload [as sendChatRequest] (src/services/perplexity-secure.js:505:43)
      at Object.sendChatRequest (__tests__/unit/perplexity-service-basic.test.js:70:38)

  console.log
    [2025-11-20T15:35:07.255Z] [INFO] API Request: model="sonar", messages=1, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:35:07.256Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:35:07.257Z] [INFO] Request payload summary: model=sonar, messages=1, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:35:07.259Z] [INFO] API Request: model="sonar", messages=3, temperature=0.2, max_tokens=1024

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:35:07.260Z] [INFO] Making API request to: /chat/completions

      at Logger.log [as info] (src/utils/logger.js:152:15)

  console.log
    [2025-11-20T15:35:07.261Z] [INFO] Request payload summary: model=sonar, messages=3, temperature=0.2

      at Logger.log [as info] (src/utils/logger.js:152:15)

--------------------------------|---------|----------|---------|---------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
File                            | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
--------------------------------|---------|----------|---------|---------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
All files                       |   69.32 |    82.21 |   68.47 |   69.32 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
 src                            |   80.34 |    78.94 |   85.71 |   80.34 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  index.js                      |   80.34 |    78.94 |   85.71 |   80.34 | 13-16,30-36,47-58,84-109,172,191-192,280-281,295-297,332-333,335-340,348-351,355-359,374-379                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
 src/commands                   |    72.8 |    76.19 |   69.44 |    72.8 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  index.js                      |    89.8 |     81.6 |   90.47 |    89.8 | 30-31,33-34,36-37,94-95,102-103,295-297,415-417,422-423,425-426,573-574,589-590,622-634,643-645,661-671,714-715,850-892,937,940                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  reminder.js                   |   27.82 |    45.45 |      40 |   27.82 | 10-11,14-15,17-32,45,48,51,69-83,88-89,99-100,103-115,144-155,157-207,209-223,225-261,263-287,289-300,302-340,343-358                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
 src/config                     |   98.26 |     91.3 |     100 |   98.26 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  config.js                     |   98.26 |     91.3 |     100 |   98.26 | 34-35,37-38                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
 src/services                   |   49.71 |    80.13 |   47.94 |   49.71 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  api-client.js                 |   90.45 |    77.27 |    87.5 |   90.45 | 39-41,75-76,80-81,91-96,135-139,145,187-188                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
  cache-manager.js              |   58.22 |    69.23 |    37.5 |   58.22 | 39-42,58-65,67-69,90-96,104-115,124-136,143-152,158-168,175-181,199-200,234-258,265-276,284-291,297-301                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
  chat.js                       |   86.83 |    79.24 |   88.88 |   86.83 | 35-37,43-51,117-119,123-124,156-158,233-263,396-405,450-452,463-465,490-491                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
  database.js                   |   81.85 |    78.97 |   83.07 |   81.85 | 242-243,265-274,296-298,342-345,359-361,377-380,435-438,442-455,458-476,489-491,536-539,586-598,630-631,676-678,706-709,766-768,787-790,807-809,826-828,858-860,879-881,916-918,922-933,950-956,958-961,965-990,1004-1007,1021-1024,1039-1042,1053-1058,1069-1072,1086-1089,1110-1113,1148-1151,1192-1204,1211-1223,1231-1232                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
  perplexity-secure.js          |    80.6 |    81.08 |      80 |    80.6 | 29-39,124-135,143-150,172-176,190-193,260-262,295-296,325-330,518,546,548,659-663,692-693,712-713,715-719,721-726,728-735,748-750,760-761,861-883,939-949,952-957,971-988,997-1004,1015-1019,1043-1045,1070-1103,1134-1172,1216-1218                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  reminder-service.js           |   20.56 |       75 |   21.42 |   20.56 | 13-24,27-39,42-85,88-106,109-121,124-165,168-184,187-188,191-219,222-238,252-261,267-272                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
  response-processor.js         |   90.15 |    82.05 |     100 |   90.15 | 24-25,54-55,59-60,71-77,82-87                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
  storage.js                    |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  throttling-service.js         |   71.42 |      100 |      40 |   71.42 | 36-48,55-56,63-67                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
  web-dashboard.js              |   16.72 |      100 |       0 |   16.72 | 13-29,32-78,85-117,124-132,138-166,173-175,184-214,220-238,244-276,286-294,303-315,323-324,330-347,353-393,400-427,434-437,444-446,453-480,487-507,514-523,530-533,540-543,550-565,572-601,608-627,635-665,674-700,709-719,729-761,771-821,831-846,853-856,863-880,887-909,916-938,945-962,969-996,1003-1041,1048-1051,1058-1073,1080-1095,1102-1117,1125-1142,1150-1180,1188-1215,1218-1257,1260-1365,1368-1444,1451-1455,1462-1479,1486-1511,1518-1537,1544-1561,1568-1579,1586-1603,1610-1624,1631-1637,1644-1656,1663-1787,1793-1824,1830-1879,1882-1917,1920-1942,1945-1959,1962-1968,1974-2022,2028-2035,2038-2105,2108-2240,2246-2293,2296-2325,2328-2362,2365-2395,2398-2426,2432-2476,2479-2555,2558-2612,2615-2625,2628-2642,2645-2689,2692-2757,2763-2774,2781-2830,2837-2857,2864-2892,2899-2911,2918-2964,2967-3003,3010-3011,3018-3044,3051-3098,3105-3106,3114-3123,3131-3136,3143-3180,3187-3217,3226-3233,3242-3261,3271-3324,3333-3340,3347-3379,3386-3406,3413-3422,3429-3438 
 src/utils                      |   84.83 |    84.46 |    82.6 |   84.83 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  cache-pruner.js               |   74.35 |    72.72 |   85.71 |   74.35 | 25-26,39-46,113-116,135-136,146-179                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
  connection-throttler.js       |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  conversation.js               |   93.64 |    89.55 |     100 |   93.64 | 53,79-80,84-90,100-106,257-259,279-280                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
  debouncer.js                  |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  discord-analytics.js          |   59.76 |    88.05 |   39.47 |   59.76 | 10-19,152-153,183-184,356-357,359-360,374-393,402-422,429-439,446-466,473-493,500-513,522-549,558-572,581-607,616-637,646-675,682,686,690,694,698-710,713-728,731-742,745-753,756-757,760-762,765-768                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
  emoji.js                      |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  enhanced-cache.js             |   82.95 |    78.31 |   75.86 |   82.95 | 72-73,80-81,170-173,223-229,250-252,265-266,275-290,363,374-375,377-378,381-382,420-432,438-459,465-472,509-510,514,524-526,533-538                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
  error-handler.js              |     100 |    94.38 |     100 |     100 | 149,201,216,258-259                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
  input-validator.js            |   74.01 |    65.17 |   83.78 |   74.01 | 61-62,108-109,121-122,135-139,151-152,175-179,195-199,213-214,219-220,258-262,273-287,295-308,314-329,332-344,357-361,366-367,371-375,385-386,391-395,403-404,407-408,411-412,415-416,434-438,452-453,493-494,513-521,550-551,562-584,614-620,629-640,654-660,663-669,692-697,739-743                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
  lazy-loader.js                |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  logger.js                     |   97.14 |    98.03 |    90.9 |   97.14 | 96-97,238-242                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
  memory-monitor.js             |   88.29 |    67.34 |     100 |   88.29 | 14-22,28,31,50-53,57-58,112-113,153-154,182-184                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  message-chunker.js            |   95.06 |    91.26 |   95.23 |   95.06 | 79-80,131-134,174-176,180-181,236-237,295-296,321-322,334-345                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
  message-formatter.js          |   91.37 |     82.5 |     100 |   91.37 | 71-75,83-84,90-91,110,126-127,157,167-168                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
  natural-language-reminder.js  |   93.12 |       75 |     100 |   93.12 | 167-168,185-187,197-202,244-251,273-279                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
  performance-dashboard.js      |   90.63 |    85.31 |   97.14 |   90.63 | 13-20,36-50,113-117,147-155,557-560,576-577,614-619,622-627,634-639,675-678,681-682,720-721,737-738,741-742,757-758,776-777,781-782                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
  performance-monitor.js        |   72.85 |    70.27 |      60 |   72.85 | 22-23,30-31,40-41,49-51,60-62,104-105,113-115,123-135,156-164,166-169,184-206,220-224,243-246,254-257                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
  performance-tracker.js        |   96.15 |      100 |   85.71 |   96.15 | 8-14                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
  pi-detector.js                |   97.07 |    81.81 |     100 |   97.07 | 95-97,349,353,359,363,369,373,377,381,469-471                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
  resource-optimizer.js         |   95.53 |    88.02 |   96.77 |   95.53 | 10-22,98,290,436,450-451,462-463,472-473,486-487,576-577                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
  security-monitor.js           |   93.72 |    89.47 |     100 |   93.72 | 43-45,167-169,172-174,177-179,182-184,201-202                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
  testUtils.js                  |     100 |      100 |     100 |     100 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  time-parser.js                |    39.8 |       50 |    7.69 |    39.8 | 5-7,40-84,93-96,105-108,117-131,139-161,169-177,185-193,201-209,218-239,247-248,255-256,265-303                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
 src/utils/message-chunking     |   78.38 |    75.47 |    85.1 |   78.38 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  chunk-boundary-handler.js     |   77.85 |    64.44 |     100 |   77.85 | 44-52,71-81,88-89,94-95,100-101,106-107,112-113,126-134,167-173,177-183,241-244,279-281,286-291                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  index.js                      |   54.22 |       50 |   33.33 |   54.22 | 50-73,83-93,100-129                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
  source-reference-processor.js |   75.57 |       84 |   72.22 |   75.57 | 24-35,42-53,80-85,105-111,148-154,163-166,244-245,254-260,265-273,278-280,295-300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
  url-formatter.js              |   88.46 |    85.29 |     100 |   88.46 | 88-93,137-143,154-159,178-183,296-301,312-314,324-325,341-343,401-406,428-433                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
--------------------------------|---------|----------|---------|---------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
